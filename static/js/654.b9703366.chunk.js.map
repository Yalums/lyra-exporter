{"version":3,"file":"static/js/654.b9703366.chunk.js","mappings":"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","sources":["utils/export/pdfFontHelper.js","utils/export/pdfTextHelpers.js","utils/export/pdfLatexRenderer.js","utils/export/pdfContentRenderers.js","utils/export/pdfExportManager.js"],"sourcesContent":["// utils/export/pdfFontHelper.js\n// PDF -  ARUDJingxihei () \n//\n// \n// -  public/fonts/ARUDJingxihei-Regular.ttf ()\n// -  public/fonts/ARUDJingxihei-Bold.ttf ()\n// -  public/fonts/ARUDJingxihei-Light.ttf ()\n// - \n// - Content-TypeTTFcmap\n\n/**\n *  Unicode cmap\n * @param {ArrayBuffer} arrayBuffer - \n * @returns {boolean} -  cmap\n */\nfunction hasUnicodeCmap(arrayBuffer) {\n  try {\n    const dataView = new DataView(arrayBuffer);\n    \n    // TTF \n    const version = dataView.getUint32(0, false);\n    // 0x00010000  'true'  'typ1'  'OTTO'\n    if (version !== 0x00010000 && version !== 0x74727565) {\n      console.warn('[PDF] TTF');\n    }\n    \n    // :  'cmap' \n    const buffer = new Uint8Array(arrayBuffer);\n    const cmapSignature = [0x63, 0x6d, 0x61, 0x70]; // 'cmap'\n    \n    for (let i = 0; i < Math.min(buffer.length - 4, 1000); i++) {\n      if (buffer[i] === cmapSignature[0] &&\n          buffer[i+1] === cmapSignature[1] &&\n          buffer[i+2] === cmapSignature[2] &&\n          buffer[i+3] === cmapSignature[3]) {\n        console.log('[PDF]  cmap ');\n        return true;\n      }\n    }\n    \n    console.warn('[PDF]  cmap ');\n    return false;\n  } catch (error) {\n    console.error('[PDF] cmap :', error);\n    return false;\n  }\n}\n\n/**\n * PDF\n * @param {jsPDF} pdf - jsPDF\n * @param {string} fontPath -  (public)\n * @param {string} fontName - \n * @param {string} fontStyle -  (normal, bold, light )\n * @returns {Promise<boolean>} - \n */\nasync function loadFontFromProject(pdf, fontPath, fontName = 'CustomFont', fontStyle = 'normal') {\n  try {\n    console.log(`[PDF] : ${fontPath}`);\n\n    // \n    const { arrayBuffer, base64 } = await loadFontData(fontPath);\n\n    //  cmap \n    if (!FontCache.has(fontPath)) {\n      const hasCmap = hasUnicodeCmap(arrayBuffer);\n      if (!hasCmap) {\n        console.warn(`[PDF] :  Unicode cmap `);\n      }\n    }\n\n    // jsPDF\n    const fileName = fontPath.split('/').pop();\n\n    try {\n      pdf.addFileToVFS(fileName, base64);\n      pdf.addFont(fileName, fontName, fontStyle);\n      console.log(`[PDF]  : ${fontName}-${fontStyle}`);\n      return true;\n    } catch (addFontError) {\n      console.error(`[PDF] addFont :`, addFontError.message);\n      console.error(`[PDF]  jsPDF`);\n      return false;\n    }\n  } catch (error) {\n    console.error('[PDF] :', error);\n    return false;\n  }\n}\n\n/**\n * PDF\n *  RegularLightBold \n *\n * @param {jsPDF} pdf - jsPDF\n * @returns {Promise<{success: boolean, fontName: string, availableWeights: string[]}>} - \n */\nexport async function addChineseFontSupport(pdf) {\n  console.log('[PDF]  ARUDJingxihei ...');\n\n  //  - \n  const fontConfigs = [\n    {\n      path: '/lyra-exporter/fonts/ARUDJingxihei-Regular.ttf',\n      name: 'ARUDJingxihei',\n      style: 'normal',\n      weight: 400,\n      description: 'Regular ()'\n    },\n    {\n      path: '/lyra-exporter/fonts/ARUDJingxihei-Bold.ttf',\n      name: 'ARUDJingxihei',\n      style: 'bold',\n      weight: 700,\n      description: 'Bold ()'\n    },\n    {\n      path: '/lyra-exporter/fonts/ARUDJingxihei-Light.ttf',\n      name: 'ARUDJingxihei',\n      style: 'light',\n      weight: 300,\n      description: 'Light ()'\n    },\n  ];\n\n  let loadedCount = 0;\n  let fontName = 'helvetica';\n  const availableWeights = [];\n\n  for (const config of fontConfigs) {\n    try {\n      const success = await loadFontFromProject(\n        pdf,\n        config.path,\n        config.name,\n        config.style  // \n      );\n      if (success) {\n        loadedCount++;\n        fontName = config.name;\n        availableWeights.push(config.style);\n        console.log(`[PDF]  : ${config.name}-${config.style} (${config.description})`);\n      }\n    } catch (error) {\n      console.warn(`[PDF]  : ${config.path} - ${error.message}`);\n    }\n  }\n\n  if (loadedCount === 0) {\n    console.warn('[PDF]   ARUDJingxihei ');\n    console.warn('[PDF]  helvetica  ()');\n    pdf.setFont('helvetica');\n    return { success: false, fontName: 'helvetica', availableWeights: [] };\n  }\n\n  console.log(`[PDF]   ${loadedCount} : ${availableWeights.join(', ')}`);\n\n  //  normal\n  try {\n    pdf.setFont(fontName, 'normal');\n  } catch (error) {\n    console.warn('[PDF]  ');\n    pdf.setFont(fontName, availableWeights[0] || 'normal');\n  }\n\n  return { success: true, fontName, availableWeights };\n}\n\n// ====================  ====================\n\n/**\n * \n */\nconst FontLoadingState = {\n  isLoading: false,\n  isLoaded: false,\n  error: null\n};\n\n/**\n * \n * { [fontPath]: { arrayBuffer, base64, timestamp } }\n */\nconst FontCache = new Map();\n\n/**\n * \n * @param {string} fontPath - \n * @returns {Promise<{arrayBuffer: ArrayBuffer, base64: string}>} - \n */\nasync function loadFontData(fontPath) {\n  // 1. \n  if (FontCache.has(fontPath)) {\n    const cached = FontCache.get(fontPath);\n    console.log(`[PDF]  : ${fontPath}`);\n    return { arrayBuffer: cached.arrayBuffer, base64: cached.base64 };\n  }\n\n  // 2.  IndexedDB \n  try {\n    const dbCache = await loadFromIndexedDB(fontPath);\n    if (dbCache) {\n      console.log(`[PDF]   IndexedDB : ${fontPath}`);\n      // \n      FontCache.set(fontPath, {\n        arrayBuffer: dbCache.arrayBuffer,\n        base64: dbCache.base64,\n        timestamp: Date.now()\n      });\n      return dbCache;\n    }\n  } catch (error) {\n    console.warn(`[PDF] IndexedDB : ${error.message}`);\n  }\n\n  // 3. \n  console.log(`[PDF] : ${fontPath}`);\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), 10000); // 10\n\n  try {\n    //  cacheBuster\n    const response = await fetch(fontPath, {\n      signal: controller.signal,\n      cache: 'force-cache', // \n    });\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const contentType = response.headers.get('content-type');\n    if (contentType && contentType.includes('text/html')) {\n      throw new Error('HTML');\n    }\n\n    const arrayBuffer = await response.arrayBuffer();\n    const fileSizeMB = (arrayBuffer.byteLength / 1024 / 1024).toFixed(2);\n    console.log(`[PDF] : ${fileSizeMB} MB`);\n\n    // TTF\n    const dataView = new DataView(arrayBuffer);\n    const magic = dataView.getUint32(0, false);\n    if (magic !== 0x00010000 && magic !== 0x74727565) {\n      throw new Error(`TTF: 0x${magic.toString(16)}`);\n    }\n\n    // \n    if (arrayBuffer.byteLength < 500 * 1024) {\n      throw new Error(` (${fileSizeMB} MB)`);\n    }\n\n    //  base64\n    const bytes = new Uint8Array(arrayBuffer);\n    let binary = '';\n    const chunkSize = 8192;\n    for (let i = 0; i < bytes.length; i += chunkSize) {\n      const chunk = bytes.subarray(i, Math.min(i + chunkSize, bytes.length));\n      binary += String.fromCharCode.apply(null, chunk);\n    }\n    const base64 = btoa(binary);\n\n    const fontData = { arrayBuffer, base64 };\n\n    // 4. \n    FontCache.set(fontPath, {\n      arrayBuffer,\n      base64,\n      timestamp: Date.now()\n    });\n\n    // 5.  IndexedDB\n    saveToIndexedDB(fontPath, fontData).catch(err => {\n      console.warn(`[PDF] IndexedDB : ${err.message}`);\n    });\n\n    return fontData;\n  } catch (fetchError) {\n    clearTimeout(timeoutId);\n    if (fetchError.name === 'AbortError') {\n      throw new Error('');\n    }\n    throw fetchError;\n  }\n}\n\n/**\n *  IndexedDB \n * @param {string} fontPath - \n * @returns {Promise<{arrayBuffer: ArrayBuffer, base64: string} | null>}\n */\nasync function loadFromIndexedDB(fontPath) {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('LyraFontCache', 1);\n\n    request.onerror = () => reject(request.error);\n\n    request.onupgradeneeded = (event) => {\n      const db = event.target.result;\n      if (!db.objectStoreNames.contains('fonts')) {\n        db.createObjectStore('fonts', { keyPath: 'path' });\n      }\n    };\n\n    request.onsuccess = () => {\n      const db = request.result;\n      try {\n        const transaction = db.transaction(['fonts'], 'readonly');\n        const store = transaction.objectStore('fonts');\n        const getRequest = store.get(fontPath);\n\n        getRequest.onsuccess = () => {\n          const data = getRequest.result;\n          if (data && data.arrayBuffer && data.base64) {\n            resolve({ arrayBuffer: data.arrayBuffer, base64: data.base64 });\n          } else {\n            resolve(null);\n          }\n        };\n\n        getRequest.onerror = () => resolve(null);\n      } catch (error) {\n        resolve(null);\n      } finally {\n        db.close();\n      }\n    };\n  });\n}\n\n/**\n *  IndexedDB\n * @param {string} fontPath - \n * @param {{arrayBuffer: ArrayBuffer, base64: string}} fontData - \n * @returns {Promise<void>}\n */\nasync function saveToIndexedDB(fontPath, fontData) {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open('LyraFontCache', 1);\n\n    request.onerror = () => reject(request.error);\n\n    request.onupgradeneeded = (event) => {\n      const db = event.target.result;\n      if (!db.objectStoreNames.contains('fonts')) {\n        db.createObjectStore('fonts', { keyPath: 'path' });\n      }\n    };\n\n    request.onsuccess = () => {\n      const db = request.result;\n      try {\n        const transaction = db.transaction(['fonts'], 'readwrite');\n        const store = transaction.objectStore('fonts');\n\n        store.put({\n          path: fontPath,\n          arrayBuffer: fontData.arrayBuffer,\n          base64: fontData.base64,\n          timestamp: Date.now()\n        });\n\n        transaction.oncomplete = () => {\n          console.log(`[PDF]   IndexedDB: ${fontPath}`);\n          resolve();\n        };\n\n        transaction.onerror = () => reject(transaction.error);\n      } catch (error) {\n        reject(error);\n      } finally {\n        db.close();\n      }\n    };\n  });\n}\n\n/**\n *  IndexedDB \n * @param {string[]} fontPaths - \n * @returns {Promise<boolean>} - \n */\nasync function checkCacheExists(fontPaths) {\n  try {\n    const checkPromises = fontPaths.map(async (path) => {\n      const cached = await loadFromIndexedDB(path);\n      return cached !== null;\n    });\n\n    const results = await Promise.all(checkPromises);\n    return results.every(r => r); //  true\n  } catch (error) {\n    console.warn('[PDF] :', error.message);\n    return false;\n  }\n}\n\n/**\n *  + IndexedDB\n * @param {boolean} silent -  isLoading \n * @returns {Promise<boolean>} - \n */\nexport async function preloadFont(silent = false) {\n  if (FontLoadingState.isLoading || FontLoadingState.isLoaded) {\n    return FontLoadingState.isLoaded;\n  }\n\n  const fontPaths = [\n    '/lyra-exporter/fonts/ARUDJingxihei-Regular.ttf',\n    '/lyra-exporter/fonts/ARUDJingxihei-Bold.ttf',\n    '/lyra-exporter/fonts/ARUDJingxihei-Light.ttf'\n  ];\n\n  // \n  const cacheExists = await checkCacheExists(fontPaths);\n\n  if (cacheExists) {\n    console.log('[PDF]  ...');\n    // \n    try {\n      const loadPromises = fontPaths.map(path => loadFontData(path));\n      await Promise.all(loadPromises);\n      FontLoadingState.isLoaded = true;\n      console.log('[PDF]  ');\n      return true;\n    } catch (error) {\n      console.warn('[PDF] :', error.message);\n      // \n    }\n  }\n\n  // \n  if (!silent) {\n    FontLoadingState.isLoading = true;\n  }\n  FontLoadingState.error = null;\n\n  try {\n    console.log('[PDF] ...');\n\n    const loadPromises = fontPaths.map(async (path) => {\n      try {\n        await loadFontData(path);\n        return true;\n      } catch (error) {\n        console.warn(`[PDF] : ${path}`, error.message);\n        return false;\n      }\n    });\n\n    const results = await Promise.all(loadPromises);\n    const successCount = results.filter(r => r).length;\n    FontLoadingState.isLoaded = successCount > 0;\n    FontLoadingState.isLoading = false;\n\n    console.log(`[PDF]  ${successCount}/${fontPaths.length} `);\n\n    return FontLoadingState.isLoaded;\n  } catch (error) {\n    console.error('[PDF] :', error);\n    FontLoadingState.error = error.message;\n    FontLoadingState.isLoading = false;\n    FontLoadingState.isLoaded = false;\n    return false;\n  }\n}\n\n/**\n * \n * @returns {object} - \n */\nexport function getFontStatus() {\n  return {\n    isLoading: FontLoadingState.isLoading,\n    isLoaded: FontLoadingState.isLoaded,\n    error: FontLoadingState.error\n  };\n}\n","// utils/export/pdfTextHelpers.js\n// PDF - \n\n/**\n * \n * @param {string} text - \n * @returns {string} - \n */\nexport function cleanCodeText(text) {\n  if (!text || typeof text !== 'string') {\n    return '';\n  }\n\n  try {\n    // 1. Unicode NFC \n    let cleaned = text.normalize('NFC');\n\n    // 2. \n    cleaned = cleaned.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n    // 3. \n    cleaned = cleaned.replace(/[\\u200B-\\u200F\\u2060\\uFEFF]/g, '');\n\n    // \n    return cleaned;\n  } catch (error) {\n    console.error('[PDF] :', error);\n    // \n    return text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]/g, '');\n  }\n}\n\n/**\n * \n * @param {string} text - \n * @returns {string} - \n */\nexport function cleanText(text) {\n  if (!text || typeof text !== 'string') {\n    return '';\n  }\n\n  try {\n    // 1. Unicode NFC \n    let cleaned = text.normalize('NFC');\n\n    // 2. \n    cleaned = cleaned.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n    // 3. Latinligatures\n    const ligatureMap = {\n      '\\uFB00': 'ff',    // \n      '\\uFB01': 'fi',    // \n      '\\uFB02': 'fl',    // \n      '\\uFB03': 'ffi',   // \n      '\\uFB04': 'ffl',   // \n      '\\uFB05': 'st',    // \n      '\\uFB06': 'st',    // \n      '\\u00C6': 'AE',    // \n      '\\u00E6': 'ae',    // \n      '\\u0152': 'OE',    // \n      '\\u0153': 'oe',    // \n      '\\u00DF': 'ss',    // \n      '\\u1E9E': 'SS',    // \n    };\n\n    // \n    for (const [ligature, replacement] of Object.entries(ligatureMap)) {\n      cleaned = cleaned.replace(new RegExp(ligature, 'g'), replacement);\n    }\n\n    // 4. UnicodejsPDF\n    // \n    cleaned = cleaned.replace(/[\\u200B-\\u200F\\u2060\\uFEFF]/g, '');\n\n    // 6. \n    // ASCII\n    const quoteMap = {\n      // \n      '\\u201C': '\"',  // \" () -> \"\n      '\\u201D': '\"',  // \" () -> \"\n      '\\u2018': \"'\",  // ' () -> '\n      '\\u2019': \"'\",  // ' () -> '\n      '\\u2033': '\"',  //  () -> \"\n      '\\u2032': \"'\",  //  () -> '\n\n      // \n      '\\u2014': '--', //  (em dash) -> --\n      '\\u2013': '-',  //  (en dash) -> -\n      '\\u2026': '...', //  () -> ...\n      '\\u2022': '',  //  () -> \n      '\\u00B7': '',  //  ()\n\n      // \n      '\\u2217': '*',  //  () -> *\n      '\\u2731': '*',  //  () -> *\n      '\\u2732': '*',  //  () -> *\n      '\\u2605': '*',  //  () -> *\n      '\\u2606': '*',  //  () -> *\n\n      // \n      '\\u2795': '+',  //  () -> +\n      '\\uFF0B': '+',  //  () -> +\n    };\n\n    // \n    for (const [from, to] of Object.entries(quoteMap)) {\n      cleaned = cleaned.replace(new RegExp(from, 'g'), to);\n    }\n\n    // 7. \n    // \n    cleaned = cleaned.replace(/[\\uFF10-\\uFF19]/g, (ch) => {\n      return String.fromCharCode(ch.charCodeAt(0) - 0xFEE0);\n    });\n    cleaned = cleaned.replace(/[\\uFF21-\\uFF3A]/g, (ch) => {\n      return String.fromCharCode(ch.charCodeAt(0) - 0xFEE0);\n    });\n    cleaned = cleaned.replace(/[\\uFF41-\\uFF5A]/g, (ch) => {\n      return String.fromCharCode(ch.charCodeAt(0) - 0xFEE0);\n    });\n\n    // \n    cleaned = cleaned.replace(/\\u3000/g, ' ');\n\n    return cleaned;\n  } catch (error) {\n    console.error('[PDF] :', error);\n    // \n    return text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]/g, '');\n  }\n}\n\n/**\n * LaTeX\n */\nexport function parseTextWithCodeBlocksAndLatex(text) {\n  const parts = [];\n  const elements = [];\n\n  // \n  const codeBlockRegex = /```([^\\n]*?)\\s*\\n([\\s\\S]*?)```/g;\n  let match;\n  let lastIndex = 0;\n\n  while ((match = codeBlockRegex.exec(text)) !== null) {\n    const language = (match[1] || '').trim().toLowerCase(); // \n    const content = match[2];\n\n    // LaTeX\n    if (language === 'latex' || language === 'math') {\n      console.log('[] LaTeX:', language);\n      elements.push({\n        start: match.index,\n        end: match.index + match[0].length,\n        type: 'latex-display',\n        content: content.trim()\n      });\n    } else {\n      // \n      elements.push({\n        start: match.index,\n        end: match.index + match[0].length,\n        type: 'code',\n        language: language,\n        content: content\n      });\n    }\n  }\n\n  // LaTeX display math ($$...$$)\n  const latexDisplayRegex = /\\$\\$\\n?([\\s\\S]*?)\\n?\\$\\$/g;\n  while ((match = latexDisplayRegex.exec(text)) !== null) {\n    elements.push({\n      start: match.index,\n      end: match.index + match[0].length,\n      type: 'latex-display',\n      content: match[1].trim()\n    });\n  }\n\n  // LaTeX display math (\\[...\\])\n  const latexBracketRegex = /\\\\\\[([\\s\\S]*?)\\\\\\]/g;\n  while ((match = latexBracketRegex.exec(text)) !== null) {\n    elements.push({\n      start: match.index,\n      end: match.index + match[0].length,\n      type: 'latex-display',\n      content: match[1].trim()\n    });\n  }\n\n  // \n  elements.sort((a, b) => a.start - b.start);\n\n  // \n  const filteredElements = [];\n  elements.forEach(element => {\n    const overlaps = filteredElements.some(existing =>\n      (element.start >= existing.start && element.start < existing.end) ||\n      (element.end > existing.start && element.end <= existing.end) ||\n      (element.start <= existing.start && element.end >= existing.end)\n    );\n    if (!overlaps) {\n      filteredElements.push(element);\n    }\n  });\n\n  // parts\n  lastIndex = 0;\n  filteredElements.forEach(element => {\n    // \n    if (element.start > lastIndex) {\n      const plainText = text.substring(lastIndex, element.start);\n      if (plainText.trim()) {\n        parts.push({ type: 'text', content: plainText });\n      }\n    }\n\n    // \n    parts.push(element);\n    lastIndex = element.end;\n  });\n\n  // \n  if (lastIndex < text.length) {\n    const plainText = text.substring(lastIndex);\n    if (plainText.trim()) {\n      parts.push({ type: 'text', content: plainText });\n    }\n  }\n\n  // ,\n  if (parts.length === 0) {\n    parts.push({ type: 'text', content: text });\n  }\n\n  return parts;\n}\n\n/**\n * markdownLaTeX\n * \n *  **$...$** LaTeX\n */\nexport function parseInlineMarkdown(text) {\n  const segments = [];\n\n  // \n  // /\n  const patterns = [\n    { type: 'bold-italic', regex: /\\*\\*\\*(.+?)\\*\\*\\*/g, recursive: true },\n    { type: 'bold-italic', regex: /___(.+?)___/g, recursive: true },\n    { type: 'bold', regex: /\\*\\*(.+?)\\*\\*/g, recursive: true },\n    { type: 'bold', regex: /__(.+?)__/g, recursive: true },\n    { type: 'italic', regex: /\\*([^*]+?)\\*/g, recursive: true },\n    { type: 'italic', regex: /_([^_]+?)_/g, recursive: true },\n    { type: 'latex-inline', regex: /\\$([^\\$\\n]+?)\\$/g, recursive: false },\n    { type: 'latex-inline', regex: /\\\\\\(([^)]*?)\\\\\\)/g, recursive: false },\n    { type: 'code', regex: /`([^`]+)`/g, recursive: false },\n    { type: 'link', regex: /\\[([^\\]]+)\\]\\(([^)]+)\\)/g, recursive: false }\n  ];\n\n  // \n  const matches = [];\n  patterns.forEach(pattern => {\n    let match;\n    const regex = new RegExp(pattern.regex.source, 'g');\n    while ((match = regex.exec(text)) !== null) {\n      matches.push({\n        type: pattern.type,\n        start: match.index,\n        end: regex.lastIndex,\n        text: match[1],\n        url: match[2],\n        recursive: pattern.recursive\n      });\n    }\n  });\n\n  // \n  matches.sort((a, b) => a.start - b.start);\n\n  // \n  const filteredMatches = [];\n  matches.forEach(match => {\n    const overlaps = filteredMatches.some(existing =>\n      (match.start >= existing.start && match.start < existing.end) ||\n      (match.end > existing.start && match.end <= existing.end)\n    );\n    if (!overlaps) {\n      filteredMatches.push(match);\n    }\n  });\n\n  // segments\n  let lastEnd = 0;\n  filteredMatches.forEach(match => {\n    // \n    if (match.start > lastEnd) {\n      segments.push({\n        type: 'normal',\n        text: cleanText(text.substring(lastEnd, match.start))\n      });\n    }\n\n    // \n    if (match.recursive && match.type !== 'latex-inline') {\n      // /LaTeX\n      const innerSegments = parseInlineMarkdown(match.text);\n      segments.push({\n        type: match.type,\n        children: innerSegments\n      });\n    } else {\n      // LaTeX\n      segments.push({\n        type: match.type,\n        text: match.type === 'latex-inline' ? match.text : cleanText(match.text),\n        url: match.url\n      });\n    }\n\n    lastEnd = match.end;\n  });\n\n  // \n  if (lastEnd < text.length) {\n    segments.push({\n      type: 'normal',\n      text: cleanText(text.substring(lastEnd))\n    });\n  }\n\n  // \n  if (segments.length === 0) {\n    segments.push({\n      type: 'normal',\n      text: cleanText(text)\n    });\n  }\n\n  return segments;\n}\n\n/**\n * \n * @param {string[]} lines - \n * @returns {string[]} - \n */\nexport function applyCJKPunctuationRules(lines) {\n  if (!lines || lines.length <= 1) return lines;\n\n  // \n  const noLineStart = /^[\"',.;:!?)}\\]]/;\n  // \n  const noLineEnd = /[\"'(\\[{]$/;\n\n  const result = [];\n  let prevLine = lines[0];\n\n  for (let i = 1; i < lines.length; i++) {\n    const currentLine = lines[i];\n\n    // \n    if (noLineStart.test(currentLine)) {\n      // \n      const punct = currentLine[0];\n      prevLine = prevLine + punct;\n      lines[i] = currentLine.substring(1);\n      continue;\n    }\n\n    // \n    if (noLineEnd.test(prevLine)) {\n      // \n      const punct = prevLine[prevLine.length - 1];\n      prevLine = prevLine.substring(0, prevLine.length - 1);\n      lines[i] = punct + currentLine;\n    }\n\n    result.push(prevLine);\n    prevLine = lines[i];\n  }\n\n  result.push(prevLine);\n  return result;\n}\n\n/**\n * \n *  [{text: string, bold: boolean, heading: number}]\n */\nexport function parseCodeLineBold(line) {\n  const segments = [];\n\n  // ### \n  const headingMatch = line.match(/^(#{1,6})\\s+(.+)$/);\n  if (headingMatch) {\n    const level = headingMatch[1].length; // 1-6\n    const headingText = headingMatch[2];\n\n    // \n    const boldRegex = /\\*\\*([^*]+?)\\*\\*/g;\n    let lastEnd = 0;\n    let match;\n\n    while ((match = boldRegex.exec(headingText)) !== null) {\n      if (match.index > lastEnd) {\n        segments.push({\n          text: headingText.substring(lastEnd, match.index),\n          bold: false,\n          heading: level\n        });\n      }\n      segments.push({\n        text: match[1],\n        bold: true,\n        heading: level\n      });\n      lastEnd = boldRegex.lastIndex;\n    }\n\n    if (lastEnd < headingText.length) {\n      segments.push({\n        text: headingText.substring(lastEnd),\n        bold: false,\n        heading: level\n      });\n    }\n\n    if (segments.length === 0) {\n      segments.push({\n        text: headingText,\n        bold: false,\n        heading: level\n      });\n    }\n\n    return segments;\n  }\n\n  // \n  const boldRegex = /\\*\\*([^*]+?)\\*\\*/g;\n  let lastEnd = 0;\n  let match;\n\n  while ((match = boldRegex.exec(line)) !== null) {\n    // \n    if (match.index > lastEnd) {\n      segments.push({\n        text: line.substring(lastEnd, match.index),\n        bold: false\n      });\n    }\n\n    // \n    segments.push({\n      text: match[1],\n      bold: true\n    });\n\n    lastEnd = boldRegex.lastIndex;\n  }\n\n  // \n  if (lastEnd < line.length) {\n    segments.push({\n      text: line.substring(lastEnd),\n      bold: false\n    });\n  }\n\n  // \n  if (segments.length === 0) {\n    segments.push({\n      text: line,\n      bold: false\n    });\n  }\n\n  return segments;\n}\n\n/**\n * \n * @param {Object} pdf - jsPDF\n * @param {string} fontName - \n * @param {string} fontStyle - \n * @param {Array} availableFontWeights - \n * @returns {boolean} - \n */\nexport function safeSetFont(pdf, fontName, fontStyle = 'normal', availableFontWeights = []) {\n  try {\n    // \n    if (availableFontWeights.includes(fontStyle)) {\n      pdf.setFont(fontName, fontStyle);\n      return true;\n    }\n\n    // \n    console.warn(`[PDF]  ${fontStyle} ...`);\n\n    // \n    if (fontStyle === 'bold' || fontStyle === 'bolditalic') {\n      //  normal\n      if (availableFontWeights.includes('normal')) {\n        pdf.setFont(fontName, 'normal');\n        console.log(`[PDF]   normal `);\n        return false; //  false \n      }\n    }\n\n    if (fontStyle === 'italic' || fontStyle === 'bolditalic') {\n      //  light  normal\n      if (availableFontWeights.includes('light')) {\n        pdf.setFont(fontName, 'light');\n        console.log(`[PDF]   light `);\n        return false;\n      } else if (availableFontWeights.includes('normal')) {\n        pdf.setFont(fontName, 'normal');\n        console.log(`[PDF]   normal `);\n        return false;\n      }\n    }\n\n    // \n    if (availableFontWeights.length > 0) {\n      const fallbackStyle = availableFontWeights[0];\n      pdf.setFont(fontName, fallbackStyle);\n      console.log(`[PDF]   ${fallbackStyle} `);\n      return false;\n    }\n\n    //  normal\n    pdf.setFont(fontName, 'normal');\n    console.log(`[PDF]   normal `);\n    return false;\n  } catch (error) {\n    console.error(`[PDF] :`, error);\n    // \n    pdf.setFont(fontName || 'helvetica');\n    return false;\n  }\n}\n\n/**\n * \n * @param {Object} pdf - jsPDF\n * @param {string} text - \n * @param {string} chineseFontName - \n * @returns {number} - \n */\nexport function safeGetTextWidth(pdf, text, chineseFontName = 'helvetica') {\n  if (!text || typeof text !== 'string') {\n    return 0;\n  }\n\n  try {\n    //  Unicode \n    const font = pdf.getFont();\n    if (!font.metadata || !font.metadata.Unicode) {\n      const currentStyle = font.fontStyle || 'normal';\n      console.warn(`[PDF]  (${currentStyle})  Unicode `);\n\n      // normal\n      if (currentStyle !== 'normal') {\n        console.log('[PDF]  normal ');\n        safeSetFont(pdf, chineseFontName, 'normal');\n        // \n        return pdf.getTextWidth(text);\n      } else {\n        // normal\n        console.warn('[PDF] normal ');\n        const fontSize = pdf.getFontSize();\n        return text.length * fontSize * 0.5;\n      }\n    }\n\n    return pdf.getTextWidth(text);\n  } catch (error) {\n    console.error('[PDF] getTextWidth :', error);\n    //  *  * 0.5\n    const fontSize = pdf.getFontSize();\n    return text.length * fontSize * 0.5;\n  }\n}\n\n/**\n * \n * @param {Object} pdf - jsPDF\n * @param {string} text - \n * @param {number} x - X \n * @param {number} y - Y \n * @param {number} maxWidth - \n */\nexport function safeRenderText(pdf, text, x, y, maxWidth = null) {\n  if (!text || typeof text !== 'string') {\n    return;\n  }\n\n  const cleanedText = cleanText(text);\n  if (!cleanedText) {\n    return;\n  }\n\n  //  maxWidth\n  if (maxWidth) {\n    const textWidth = safeGetTextWidth(pdf, cleanedText);\n    if (textWidth > maxWidth) {\n      // \n      console.warn('[PDF] :', cleanedText.substring(0, 50));\n      //  splitTextToSize \n      try {\n        const lines = pdf.splitTextToSize(cleanedText, maxWidth);\n        if (lines.length > 0) {\n          pdf.text(lines[0], x, y);\n        }\n      } catch (error) {\n        // \n        let truncated = cleanedText;\n        while (safeGetTextWidth(pdf, truncated + '...') > maxWidth && truncated.length > 0) {\n          truncated = truncated.substring(0, truncated.length - 1);\n        }\n        pdf.text(truncated + '...', x, y);\n      }\n      return;\n    }\n  }\n\n  // \n  pdf.text(cleanedText, x, y);\n}","// utils/export/pdfLatexRenderer.js\n// LaTeX - UnicodeSVG\n// LaTeX\n\nimport { cleanText } from './pdfTextHelpers';\n\n// ============  ============\nconst LATEX_RENDER_CONSTANTS = {\n  // \n  FRACTION_FONT_SCALE: 0.75,      // \n  SUPERSCRIPT_FONT_SCALE: 0.7,    // \n  SUBSCRIPT_FONT_SCALE: 0.7,      // \n  DISPLAY_FONT_SCALE: 1.2,        // \n  \n  // fontSize\n  FRACTION_NUM_OFFSET: 0.17,      // \n  FRACTION_DEN_OFFSET: 0.5,       // \n  SUPERSCRIPT_OFFSET: 0.3,        // \n  SUBSCRIPT_OFFSET: 0.3,          // \n  \n  // \n  FRACTION_PADDING: 4,            // padding\n  SQRT_PADDING: 8,                // padding\n  CACHE_MAX_SIZE: 500,            // \n};\n\n/**\n * LaTeXUnicode\n */\nconst LATEX_UNICODE_MAP = {\n  // \n  'alpha': '', 'beta': '', 'gamma': '', 'delta': '',\n  'epsilon': '', 'varepsilon': '', 'zeta': '', 'eta': '',\n  'theta': '', 'vartheta': '', 'iota': '', 'kappa': '',\n  'lambda': '', 'mu': '', 'nu': '', 'xi': '',\n  'pi': '', 'varpi': '', 'rho': '', 'varrho': '',\n  'sigma': '', 'varsigma': '', 'tau': '', 'upsilon': '',\n  'phi': '', 'varphi': '', 'chi': '', 'psi': '', 'omega': '',\n  \n  // \n  'Alpha': '', 'Beta': '', 'Gamma': '', 'Delta': '',\n  'Epsilon': '', 'Zeta': '', 'Eta': '', 'Theta': '',\n  'Iota': '', 'Kappa': '', 'Lambda': '', 'Mu': '',\n  'Nu': '', 'Xi': '', 'Pi': '', 'Rho': '',\n  'Sigma': '', 'Tau': '', 'Upsilon': '', 'Phi': '',\n  'Chi': '', 'Psi': '', 'Omega': '',\n  \n  // \n  'pm': '', 'mp': '', 'times': '', 'div': '',\n  'cdot': '', 'ast': '', 'star': '', 'circ': '',\n  'bullet': '', 'oplus': '', 'ominus': '', 'otimes': '',\n  'oslash': '', 'odot': '', 'dagger': '', 'ddagger': '',\n  \n  // \n  'leq': '', 'le': '', 'geq': '', 'ge': '',\n  'neq': '', 'ne': '', 'approx': '', 'equiv': '',\n  'sim': '', 'simeq': '', 'propto': '', 'perp': '',\n  'parallel': '', 'subset': '', 'supset': '',\n  'subseteq': '', 'supseteq': '', 'in': '', 'notin': '',\n  \n  // \n  'leftarrow': '', 'rightarrow': '', 'uparrow': '', 'downarrow': '',\n  'leftrightarrow': '', 'updownarrow': '', 'Leftarrow': '', 'Rightarrow': '',\n  'Uparrow': '', 'Downarrow': '', 'Leftrightarrow': '', 'Updownarrow': '',\n  'mapsto': '', 'to': '', 'gets': '',\n  \n  // \n  'infty': '', 'partial': '', 'nabla': '', 'forall': '',\n  'exists': '', 'nexists': '', 'emptyset': '', 'varnothing': '',\n  'complement': '', 'neg': '', 'wedge': '', 'vee': '',\n  'cap': '', 'cup': '', 'int': '', 'iint': '', 'iiint': '',\n  'oint': '', 'sum': '', 'prod': '', 'coprod': '',\n  'bigcap': '', 'bigcup': '', 'bigvee': '', 'bigwedge': '',\n  'bigoplus': '', 'bigotimes': '', 'bigodot': '', 'biguplus': '',\n  \n  // \n  'langle': '', 'rangle': '', 'lfloor': '', 'rfloor': '',\n  'lceil': '', 'rceil': '', 'vert': '|', 'Vert': '',\n  \n  // \n  'dots': '', 'cdots': '', 'vdots': '', 'ddots': '',\n  'ldots': '', 'therefore': '', 'because': '',\n  'angle': '', 'measuredangle': '', 'sphericalangle': '',\n  \n  // \n  'prime': '', 'backprime': '', 'degree': '',\n\n  // \n  'sin': 'sin', 'cos': 'cos', 'tan': 'tan',\n  'cot': 'cot', 'sec': 'sec', 'csc': 'csc',\n  'arcsin': 'arcsin', 'arccos': 'arccos', 'arctan': 'arctan',\n  'sinh': 'sinh', 'cosh': 'cosh', 'tanh': 'tanh',\n  'log': 'log', 'ln': 'ln', 'exp': 'exp',\n  'lim': 'lim', 'max': 'max', 'min': 'min',\n  'sup': 'sup', 'inf': 'inf', 'det': 'det', 'dim': 'dim'\n};\n\n// \\mathcal{X}\nconst MATHCAL_MAP = {\n  'A': '', 'B': '', 'C': '', 'D': '', 'E': '', 'F': '',\n  'G': '', 'H': '', 'I': '', 'J': '', 'K': '', 'L': '',\n  'M': '', 'N': '', 'O': '', 'P': '', 'Q': '', 'R': '',\n  'S': '', 'T': '', 'U': '', 'V': '', 'W': '', 'X': '',\n  'Y': '', 'Z': ''\n};\n\n// \\mathbb{X}\nconst MATHBB_MAP = {\n  'A': '', 'B': '', 'C': '', 'D': '', 'E': '', 'F': '',\n  'G': '', 'H': '', 'I': '', 'J': '', 'K': '', 'L': '',\n  'M': '', 'N': '', 'O': '', 'P': '', 'Q': '', 'R': '',\n  'S': '', 'T': '', 'U': '', 'V': '', 'W': '', 'X': '',\n  'Y': '', 'Z': ''\n};\n\n// \n//  (U+00B9, U+00B2, U+00B3) \n// - (U+2070, U+2074-U+2079) \nconst SUPERSCRIPT_MAP = {\n  '0': '', '1': '', '2': '', '3': '', '4': '',\n  '5': '', '6': '', '7': '', '8': '', '9': '',\n  '+': '', '-': '', '=': '', '(': '', ')': '',\n  'n': '', 'i': '',\n  // Hermitian\n  'T': '', 'H': '', '*': '', 't': '',\n  'a': '', 'b': '', 'c': '', 'd': '', 'e': '',\n  'f': '', 'g': '', 'h': '', 'j': '', 'k': '',\n  'l': '', 'm': '', 'o': '', 'p': '', 'r': '',\n  's': '', 'u': '', 'v': '', 'w': '', 'x': '', 'y': '', 'z': ''\n};\n\n// ASCIIUnicode\nconst SUPERSCRIPT_SAFE = {\n  '0': '^0', '1': '', '2': '', '3': '', '4': '^4',\n  '5': '^5', '6': '^6', '7': '^7', '8': '^8', '9': '^9',\n  '+': '^+', '-': '^-', '=': '^=', '(': '^(', ')': '^)',\n  'n': '^n', 'i': '^i', 'T': '^T', 'H': '^H', '*': '^*',\n  't': '^t', 'a': '^a', 'b': '^b', 'c': '^c', 'd': '^d',\n  'e': '^e', 'f': '^f', 'g': '^g', 'h': '^h', 'j': '^j',\n  'k': '^k', 'l': '^l', 'm': '^m', 'o': '^o', 'p': '^p',\n  'r': '^r', 's': '^s', 'u': '^u', 'v': '^v', 'w': '^w',\n  'x': '^x', 'y': '^y', 'z': '^z'\n};\n\n// \nconst SUBSCRIPT_MAP = {\n  '0': '', '1': '', '2': '', '3': '', '4': '',\n  '5': '', '6': '', '7': '', '8': '', '9': '',\n  '+': '', '-': '', '=': '', '(': '', ')': '',\n  'a': '', 'e': '', 'h': '', 'i': '', 'j': '',\n  'k': '', 'l': '', 'm': '', 'n': '', 'o': '',\n  'p': '', 'r': '', 's': '', 't': '', 'u': '',\n  'v': '', 'x': ''\n};\n\n/**\n * \n * @param {string} str -  { \n * @returns {string|null} -  null\n */\nfunction extractBracedContent(str) {\n  if (!str || !str.startsWith('{')) return null;\n\n  let depth = 0;\n  let i = 0;\n\n  for (; i < str.length; i++) {\n    // \n    if (str[i] === '\\\\' && i + 1 < str.length) {\n      i++;\n      continue;\n    }\n    \n    if (str[i] === '{') {\n      depth++;\n    } else if (str[i] === '}') {\n      depth--;\n      if (depth === 0) {\n        return str.substring(1, i);\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * LaTeX\n */\nexport class LaTeXRenderer {\n  constructor(pdf, config = {}) {\n    this.pdf = pdf;\n    this.config = {\n      fontSize: config.fontSize || 10,\n      color: config.color || [0, 0, 0],\n      fontName: config.fontName || 'helvetica',\n      useUnicode: config.useUnicode !== false,\n      ...config\n    };\n\n    //  - \n    this.widthCache = new Map();\n    this.cacheAccessOrder = [];  // LRU\n  }\n\n  /**\n   * \n   */\n  setRenderFont(fontSize = null) {\n    if (this.config.fontName) {\n      try {\n        this.pdf.setFont(this.config.fontName, 'normal');\n      } catch (e) {\n        // \n      }\n    }\n    if (fontSize !== null) {\n      this.pdf.setFontSize(fontSize);\n    }\n  }\n\n  /**\n   * LRU\n   */\n  getCachedTextWidth(text, fontSize) {\n    const cacheKey = `${text}|${fontSize}|${this.config.fontName}`;\n\n    if (this.widthCache.has(cacheKey)) {\n      // LRU\n      const idx = this.cacheAccessOrder.indexOf(cacheKey);\n      if (idx > -1) {\n        this.cacheAccessOrder.splice(idx, 1);\n      }\n      this.cacheAccessOrder.push(cacheKey);\n      return this.widthCache.get(cacheKey);\n    }\n\n    this.setRenderFont(fontSize);\n    const width = this.pdf.getTextWidth(text);\n    \n    // \n    if (this.widthCache.size >= LATEX_RENDER_CONSTANTS.CACHE_MAX_SIZE) {\n      const oldestKey = this.cacheAccessOrder.shift();\n      if (oldestKey) {\n        this.widthCache.delete(oldestKey);\n      }\n    }\n    \n    this.widthCache.set(cacheKey, width);\n    this.cacheAccessOrder.push(cacheKey);\n\n    return width;\n  }\n\n  /**\n   * \n   */\n  clearWidthCache() {\n    this.widthCache.clear();\n    this.cacheAccessOrder = [];\n  }\n\n  /**\n   * LaTeX\n   * @param {string} latex - LaTeX$\n   * @param {number} x - X\n   * @param {number} y - Y\n   * @param {number} maxWidth - \n   * @returns {number} - \n   */\n  renderInlineLaTeX(latex, x, y, maxWidth) {\n    // Unicode\n    const simplified = this.simplifyLaTeX(latex);\n    \n    // \n    if (this.hasComplexStructure(latex)) {\n      return this.renderComplexLaTeX(latex, x, y, maxWidth, true);\n    }\n    \n    // Unicode\n    this.pdf.setFontSize(this.config.fontSize);\n    this.pdf.setTextColor(...this.config.color);\n    \n    // \n    try {\n      this.pdf.setFont(this.pdf.getFont().fontName, 'italic');\n    } catch (e) {\n      // \n    }\n    \n    this.pdf.text(simplified, x, y);\n    const width = this.pdf.getTextWidth(simplified);\n    \n    // \n    try {\n      this.pdf.setFont(this.pdf.getFont().fontName, 'normal');\n    } catch (e) {\n      // \n    }\n    \n    return width;\n  }\n\n  /**\n   * LaTeX\n   * @param {string} latex - LaTeX\n   * @param {number} x - X\n   * @param {number} y - Y\n   * @param {number} maxWidth - \n   * @returns {Object} - {width, height} \n   */\n  renderDisplayLaTeX(latex, x, y, maxWidth) {\n    // \n    const centerX = x + maxWidth / 2;\n    const { DISPLAY_FONT_SCALE } = LATEX_RENDER_CONSTANTS;\n    \n    // \n    if (this.hasComplexStructure(latex)) {\n      return this.renderComplexLaTeX(latex, centerX, y, maxWidth, false);\n    }\n    \n    // \n    const simplified = this.simplifyLaTeX(latex);\n    const fontSize = this.config.fontSize * DISPLAY_FONT_SCALE;\n    \n    this.pdf.setFontSize(fontSize);\n    this.pdf.setTextColor(...this.config.color);\n    \n    // \n    const textWidth = this.pdf.getTextWidth(simplified);\n    const startX = centerX - textWidth / 2;\n    \n    // \n    const padding = 5;\n    this.pdf.setFillColor(250, 250, 250);\n    this.pdf.rect(startX - padding, y - fontSize * 0.8, textWidth + padding * 2, fontSize * 1.5, 'F');\n    \n    // \n    this.pdf.text(simplified, startX, y);\n    \n    return {\n      width: textWidth + padding * 2,\n      height: fontSize * 1.5\n    };\n  }\n\n  /**\n   * LaTeXUnicode\n   * @param {string} latex - LaTeX\n   * @returns {string} - Unicode\n   */\n  simplifyLaTeX(latex) {\n    if (!latex) return '';\n    \n    let result = latex;\n\n    // \n    result = result.replace(/\\s+/g, ' ').trim();\n    \n    // LaTeXmatrix, cases, align\n    result = this.simplifyEnvironments(result);\n    \n    //  \\left  \\right \n    result = result.replace(/\\\\left\\(/g, '(');\n    result = result.replace(/\\\\right\\)/g, ')');\n    result = result.replace(/\\\\left\\[/g, '[');\n    result = result.replace(/\\\\right\\]/g, ']');\n    result = result.replace(/\\\\left\\\\\\{/g, '{');\n    result = result.replace(/\\\\right\\\\\\}/g, '}');\n    result = result.replace(/\\\\left\\{/g, '{');\n    result = result.replace(/\\\\right\\}/g, '}');\n    result = result.replace(/\\\\left\\|/g, '|');\n    result = result.replace(/\\\\right\\|/g, '|');\n    result = result.replace(/\\\\left\\./g, '');\n    result = result.replace(/\\\\right\\./g, '');\n\n    //  \\mathbb{X}  - \n    result = result.replace(/\\\\mathbb\\{([A-Z])\\}/g, (_, letter) => {\n      return MATHBB_MAP[letter] || letter;\n    });\n\n    //  \\mathcal{X}  - \n    result = result.replace(/\\\\mathcal\\{([A-Z])\\}/g, (_, letter) => {\n      return MATHCAL_MAP[letter] || letter;\n    });\n\n    //  \\text{}  - \n    result = result.replace(/\\\\text\\{([^}]*)\\}/g, '$1');\n\n    //  \\xleftrightarrow{}, \\xrightarrow{}, \\xleftarrow{}\n    // \n    result = result.replace(/\\\\xleftrightarrow\\{([^}]*)\\}/g, (match, inner) => {\n      const simplifiedInner = inner ? this.simplifyLaTeX(inner) : '';\n      return `[${simplifiedInner}]`;\n    });\n    result = result.replace(/\\\\xrightarrow\\{([^}]*)\\}/g, (match, inner) => {\n      const simplifiedInner = inner ? this.simplifyLaTeX(inner) : '';\n      return `[${simplifiedInner}]`;\n    });\n    result = result.replace(/\\\\xleftarrow\\{([^}]*)\\}/g, (match, inner) => {\n      const simplifiedInner = inner ? this.simplifyLaTeX(inner) : '';\n      return `[${simplifiedInner}]`;\n    });\n\n    //  \\frac{a}{b} -  a/b \n    result = this.simplifyFractions(result);\n\n    //  \\sqrt{x}  \\sqrt[n]{x}\n    result = result.replace(/\\\\sqrt\\[([^\\]]+)\\]\\{([^}]+)\\}/g, '($2)^(1/$1)');\n    result = result.replace(/\\\\sqrt\\{([^}]+)\\}/g, '($1)');\n\n    // \n    result = this.processSupSubScripts(result);\n    \n    // LaTeXUnicode\n    const sortedCommands = Object.keys(LATEX_UNICODE_MAP).sort((a, b) => b.length - a.length);\n    sortedCommands.forEach(command => {\n      const pattern = new RegExp(`\\\\\\\\${command}(?![a-zA-Z])`, 'g');\n      result = result.replace(pattern, LATEX_UNICODE_MAP[command]);\n    });\n    \n    // \n    result = result.replace(/\\\\([a-zA-Z]+)/g, '$1');\n    result = result.replace(/\\\\(.)/g, '$1');\n    \n    // \n    result = result.replace(/[{}]/g, '');\n    \n    return result;\n  }\n\n  /**\n   * \n   */\n  simplifyFractions(text) {\n    let result = text;\n    let lastResult = '';\n    \n    // \n    while (result !== lastResult) {\n      lastResult = result;\n      \n      const fracMatch = result.match(/\\\\frac/);\n      if (!fracMatch) break;\n      \n      const startIdx = fracMatch.index;\n      const afterFrac = result.substring(startIdx + 5); //  \\frac\n      \n      // \n      const numerator = extractBracedContent(afterFrac);\n      if (numerator === null) break;\n      \n      // \n      const afterNum = afterFrac.substring(numerator.length + 2);\n      const denominator = extractBracedContent(afterNum);\n      if (denominator === null) break;\n      \n      // \n      const fullMatch = result.substring(startIdx, startIdx + 5 + numerator.length + 2 + denominator.length + 2);\n      const simplified = `(${numerator})/(${denominator})`;\n      \n      result = result.replace(fullMatch, simplified);\n    }\n    \n    return result;\n  }\n\n  /**\n   * \n   */\n  processSupSubScripts(text) {\n    let result = text;\n    \n    //  ^{...}\n    let lastResult = '';\n    while (result !== lastResult) {\n      lastResult = result;\n      const supMatch = result.match(/\\^(\\{[^{}]*(?:\\{[^{}]*\\}[^{}]*)*\\}|\\w)/);\n      if (supMatch) {\n        let content = supMatch[1];\n        if (content.startsWith('{') && content.endsWith('}')) {\n          content = content.slice(1, -1);\n        }\n        const converted = this.convertToSuperscript(content);\n        result = result.replace(supMatch[0], converted);\n      }\n    }\n    \n    //  _{...}\n    lastResult = '';\n    while (result !== lastResult) {\n      lastResult = result;\n      const subMatch = result.match(/_(\\{[^{}]*(?:\\{[^{}]*\\}[^{}]*)*\\}|\\w)/);\n      if (subMatch) {\n        let content = subMatch[1];\n        if (content.startsWith('{') && content.endsWith('}')) {\n          content = content.slice(1, -1);\n        }\n        const converted = this.convertToSubscript(content);\n        result = result.replace(subMatch[0], converted);\n      }\n    }\n    \n    return result;\n  }\n\n  /**\n   * Unicode\n   */\n  convertToSuperscript(text) {\n    // LaTeX\n    const simplified = this.simplifyLaTeX(text);\n    // ^x\n    return simplified.split('').map(char => {\n      if (SUPERSCRIPT_SAFE[char]) return SUPERSCRIPT_SAFE[char];\n      if (SUPERSCRIPT_MAP[char]) return SUPERSCRIPT_MAP[char];\n      return '^' + char;  // ^x\n    }).join('');\n  }\n\n  /**\n   * Unicode\n   */\n  convertToSubscript(text) {\n    // LaTeX\n    const simplified = this.simplifyLaTeX(text);\n    // \n    return simplified.split('').map(char => {\n      if (SUBSCRIPT_MAP[char]) return SUBSCRIPT_MAP[char];\n      return '_' + char;  // _x\n    }).join('');\n  }\n\n  /**\n   * LaTeX\n   */\n  hasComplexStructure(latex) {\n    const complexPatterns = [\n      /\\\\frac\\{/,           // \n      /\\\\sqrt[\\[\\{]/,       // \n      /\\\\begin\\{/,          // cases\n      /\\\\xleftrightarrow/,  // \n      /\\\\xrightarrow/,      // \n      /\\\\xleftarrow/,       // \n      /\\\\boxed\\{/,          // \n      /\\\\underbrace\\{/,     // \n      /\\\\overbrace\\{/       // \n    ];\n\n    return complexPatterns.some(pattern => pattern.test(latex));\n  }\n\n  /**\n   * LaTeX\n   */\n  renderComplexLaTeX(latex, x, y, maxWidth, isInline) {\n    const fontSize = isInline ? this.config.fontSize : this.config.fontSize * 1.2;\n    const elements = this.parseComplexLaTeX(latex);\n\n    // \n    let totalWidth = 0;\n    this.pdf.setFontSize(fontSize);\n\n    elements.forEach(element => {\n      switch (element.type) {\n        case 'text':\n          totalWidth += this.pdf.getTextWidth(element.content);\n          break;\n\n        case 'fraction':\n          // \n          const fracFontSize = fontSize * 0.75;\n          this.pdf.setFontSize(fracFontSize);\n          const numWidth = this.pdf.getTextWidth(element.numerator);\n          const denWidth = this.pdf.getTextWidth(element.denominator);\n          totalWidth += Math.max(numWidth, denWidth) + 4;\n          this.pdf.setFontSize(fontSize);\n          break;\n\n        case 'sqrt':\n          totalWidth += this.pdf.getTextWidth(element.content) + 8;\n          break;\n\n        case 'superscript':\n        case 'subscript':\n          totalWidth += this.pdf.getTextWidth(element.base || '');\n          const subSupFontSize = fontSize * 0.7;\n          this.pdf.setFontSize(subSupFontSize);\n          totalWidth += this.pdf.getTextWidth(element.exponent || element.subscript || '');\n          this.pdf.setFontSize(fontSize);\n          break;\n\n        default:\n          totalWidth += this.pdf.getTextWidth(element.raw || '');\n      }\n    });\n\n    // display math\n    let currentX = isInline ? x : (x - totalWidth / 2);\n    let maxHeight = fontSize;\n    let hasFraction = false;  // \n\n    // \n    elements.forEach(element => {\n      switch (element.type) {\n        case 'text':\n          this.pdf.setFontSize(fontSize);\n          this.pdf.text(element.content, currentX, y);\n          const textWidth = this.pdf.getTextWidth(element.content);\n          currentX += textWidth;\n          break;\n\n        case 'fraction':\n          const fracWidth = this.renderFraction(\n            element.numerator,\n            element.denominator,\n            currentX,\n            y,\n            fontSize\n          );\n          currentX += fracWidth;\n          hasFraction = true;\n          break;\n\n        case 'sqrt':\n          const sqrtWidth = this.renderSquareRoot(\n            element.content,\n            currentX,\n            y,\n            fontSize\n          );\n          currentX += sqrtWidth;\n          break;\n\n        case 'superscript':\n          const supWidth = this.renderSuperscript(\n            element.base,\n            element.exponent,\n            currentX,\n            y,\n            fontSize\n          );\n          currentX += supWidth;\n          break;\n\n        case 'subscript':\n          const subWidth = this.renderSubscript(\n            element.base,\n            element.subscript,\n            currentX,\n            y,\n            fontSize\n          );\n          currentX += subWidth;\n          break;\n\n        default:\n          // \n          const fallbackText = element.raw || '';\n          this.pdf.setFontSize(fontSize);\n          this.pdf.text(fallbackText, currentX, y);\n          const fallbackWidth = this.pdf.getTextWidth(fallbackText);\n          currentX += fallbackWidth;\n      }\n    });\n\n    // \n    if (hasFraction) {\n      maxHeight = fontSize * 1.2;  // \n    } else {\n      maxHeight = fontSize;  // \n    }\n\n    return isInline ? totalWidth : { width: totalWidth, height: maxHeight };\n  }\n\n  /**\n   * LaTeX\n   */\n  parseComplexLaTeX(latex) {\n    const elements = [];\n    let remaining = latex;\n    \n    // \n    const fracRegex = /\\\\frac\\{([^}]*)\\}\\{([^}]*)\\}/;\n    \n    while (remaining.length > 0) {\n      const fracMatch = remaining.match(fracRegex);\n      \n      if (fracMatch) {\n        // \n        if (fracMatch.index > 0) {\n          const beforeText = remaining.substring(0, fracMatch.index);\n          const simplified = this.simplifyLaTeX(beforeText);\n          if (simplified) {\n            elements.push({ type: 'text', content: simplified });\n          }\n        }\n        \n        // \n        elements.push({\n          type: 'fraction',\n          numerator: this.simplifyLaTeX(fracMatch[1]),\n          denominator: this.simplifyLaTeX(fracMatch[2]),\n          raw: fracMatch[0]\n        });\n        \n        remaining = remaining.substring(fracMatch.index + fracMatch[0].length);\n      } else {\n        // \n        const simplified = this.simplifyLaTeX(remaining);\n        if (simplified) {\n          elements.push({ type: 'text', content: simplified });\n        }\n        break;\n      }\n    }\n    \n    return elements;\n  }\n\n  /**\n   * \n   */\n  renderFraction(numerator, denominator, x, y, fontSize) {\n    const { FRACTION_FONT_SCALE, FRACTION_NUM_OFFSET, FRACTION_DEN_OFFSET, FRACTION_PADDING } = LATEX_RENDER_CONSTANTS;\n    \n    // \n    const fracFontSize = fontSize * FRACTION_FONT_SCALE;\n    this.pdf.setFontSize(fracFontSize);\n\n    const numWidth = this.pdf.getTextWidth(numerator);\n    const denWidth = this.pdf.getTextWidth(denominator);\n    const fracWidth = Math.max(numWidth, denWidth) + FRACTION_PADDING;\n\n    // \n    const numOffset = fracFontSize * FRACTION_NUM_OFFSET;\n    const denOffset = fracFontSize * FRACTION_DEN_OFFSET;\n\n    // \n    const numX = x + (fracWidth - numWidth) / 2;\n    this.pdf.text(numerator, numX, y - numOffset);\n\n    // \n    this.pdf.setLineWidth(0.3);\n    this.pdf.setDrawColor(0, 0, 0);\n    this.pdf.line(x, y, x + fracWidth, y);\n\n    // \n    const denX = x + (fracWidth - denWidth) / 2;\n    this.pdf.text(denominator, denX, y + denOffset);\n\n    // \n    this.pdf.setFontSize(fontSize);\n\n    return fracWidth;\n  }\n\n  /**\n   * \n   */\n  renderSquareRoot(content, x, y, fontSize) {\n    const { SQRT_PADDING, DISPLAY_FONT_SCALE } = LATEX_RENDER_CONSTANTS;\n    \n    const contentWidth = this.pdf.getTextWidth(content);\n    const sqrtWidth = contentWidth + SQRT_PADDING;\n    const sqrtHeight = fontSize * DISPLAY_FONT_SCALE;\n    \n    // \n    this.pdf.setLineWidth(0.3);\n    // \n    this.pdf.line(x, y - sqrtHeight / 3, x + 2, y);\n    // \n    this.pdf.line(x + 2, y, x + 4, y - sqrtHeight);\n    // \n    this.pdf.line(x + 4, y - sqrtHeight, x + sqrtWidth, y - sqrtHeight);\n    \n    // \n    this.pdf.setFontSize(fontSize);\n    this.pdf.text(content, x + 6, y);\n    \n    return sqrtWidth;\n  }\n\n  /**\n   * \n   */\n  renderSuperscript(base, exponent, x, y, fontSize) {\n    const { SUPERSCRIPT_FONT_SCALE, SUPERSCRIPT_OFFSET } = LATEX_RENDER_CONSTANTS;\n    \n    // \n    this.pdf.setFontSize(fontSize);\n    this.pdf.text(base, x, y);\n    const baseWidth = this.pdf.getTextWidth(base);\n    \n    // \n    const supFontSize = fontSize * SUPERSCRIPT_FONT_SCALE;\n    this.pdf.setFontSize(supFontSize);\n    const supText = this.simplifyLaTeX(exponent);\n    this.pdf.text(supText, x + baseWidth, y - fontSize * SUPERSCRIPT_OFFSET);\n    const supWidth = this.pdf.getTextWidth(supText);\n    \n    // \n    this.pdf.setFontSize(fontSize);\n    \n    return baseWidth + supWidth;\n  }\n\n  /**\n   * \n   */\n  renderSubscript(base, subscript, x, y, fontSize) {\n    const { SUBSCRIPT_FONT_SCALE, SUBSCRIPT_OFFSET } = LATEX_RENDER_CONSTANTS;\n    \n    // \n    this.pdf.setFontSize(fontSize);\n    this.pdf.text(base, x, y);\n    const baseWidth = this.pdf.getTextWidth(base);\n    \n    // \n    const subFontSize = fontSize * SUBSCRIPT_FONT_SCALE;\n    this.pdf.setFontSize(subFontSize);\n    const subText = this.simplifyLaTeX(subscript);\n    this.pdf.text(subText, x + baseWidth, y + fontSize * SUBSCRIPT_OFFSET);\n    const subWidth = this.pdf.getTextWidth(subText);\n    \n    // \n    this.pdf.setFontSize(fontSize);\n    \n    return baseWidth + subWidth;\n  }\n\n  /**\n   * LaTeXmatrix, cases, align\n   * @param {string} latex - LaTeX\n   * @returns {string} - \n   */\n  simplifyEnvironments(latex) {\n    let result = latex;\n    \n    // : \\begin{matrix/pmatrix/bmatrix/vmatrix/Vmatrix/Bmatrix}...\\end{...}\n    const matrixTypes = ['matrix', 'pmatrix', 'bmatrix', 'vmatrix', 'Vmatrix', 'Bmatrix'];\n    const matrixBrackets = {\n      'matrix': ['', ''],\n      'pmatrix': ['(', ')'],\n      'bmatrix': ['[', ']'],\n      'vmatrix': ['|', '|'],\n      'Vmatrix': ['', ''],\n      'Bmatrix': ['{', '}']\n    };\n    \n    for (const mtype of matrixTypes) {\n      const regex = new RegExp(`\\\\\\\\begin\\\\{${mtype}\\\\}([\\\\s\\\\S]*?)\\\\\\\\end\\\\{${mtype}\\\\}`, 'g');\n      result = result.replace(regex, (match, content) => {\n        const [leftBracket, rightBracket] = matrixBrackets[mtype];\n        return leftBracket + this.simplifyMatrixContent(content) + rightBracket;\n      });\n    }\n    \n    // cases: \\begin{cases}...\\end{cases}\n    result = result.replace(/\\\\begin\\{cases\\}([\\s\\S]*?)\\\\end\\{cases\\}/g, (match, content) => {\n      return '{ ' + this.simplifyCasesContent(content) + ' }';\n    });\n    \n    // align/aligned: \\begin{align}...\\end{align}\n    result = result.replace(/\\\\begin\\{align\\*?\\}([\\s\\S]*?)\\\\end\\{align\\*?\\}/g, (match, content) => {\n      return this.simplifyAlignContent(content);\n    });\n    result = result.replace(/\\\\begin\\{aligned\\}([\\s\\S]*?)\\\\end\\{aligned\\}/g, (match, content) => {\n      return this.simplifyAlignContent(content);\n    });\n    \n    // equation\n    result = result.replace(/\\\\begin\\{equation\\*?\\}([\\s\\S]*?)\\\\end\\{equation\\*?\\}/g, '$1');\n    \n    // array\n    result = result.replace(/\\\\begin\\{array\\}\\{[^}]*\\}([\\s\\S]*?)\\\\end\\{array\\}/g, (match, content) => {\n      return this.simplifyMatrixContent(content);\n    });\n    \n    return result;\n  }\n  \n  /**\n   * \n   */\n  simplifyMatrixContent(content) {\n    //  \\\\\\ \n    const rows = content.split(/\\\\\\\\/).map(row => row.trim()).filter(row => row);\n    \n    //  & \n    const simplifiedRows = rows.map(row => {\n      const cells = row.split('&').map(cell => {\n        // simplifyEnvironments\n        return this.simplifyLaTeXBasic(cell.trim());\n      });\n      return cells.join(' , ');\n    });\n    \n    // \n    return simplifiedRows.join(' ; ');\n  }\n  \n  /**\n   * cases\n   */\n  simplifyCasesContent(content) {\n    // \n    const rows = content.split(/\\\\\\\\/).map(row => row.trim()).filter(row => row);\n    \n    const simplifiedRows = rows.map(row => {\n      //  & \n      const parts = row.split('&').map(part => this.simplifyLaTeXBasic(part.trim()));\n      if (parts.length >= 2) {\n        return `${parts[0]}, if ${parts[1]}`;\n      }\n      return parts[0];\n    });\n    \n    return simplifiedRows.join(' | ');\n  }\n  \n  /**\n   * align\n   */\n  simplifyAlignContent(content) {\n    // \n    const rows = content.split(/\\\\\\\\/).map(row => row.trim()).filter(row => row);\n    \n    const simplifiedRows = rows.map(row => {\n      //  &\n      return this.simplifyLaTeXBasic(row.replace(/&/g, ' '));\n    });\n    \n    return simplifiedRows.join(' ; ');\n  }\n  \n  /**\n   * LaTeX\n   */\n  simplifyLaTeXBasic(latex) {\n    if (!latex) return '';\n    \n    let result = latex;\n    \n    // \n    result = result.replace(/\\\\mathbb\\{([A-Z])\\}/g, (_, letter) => MATHBB_MAP[letter] || letter);\n    result = result.replace(/\\\\mathcal\\{([A-Z])\\}/g, (_, letter) => MATHCAL_MAP[letter] || letter);\n    result = result.replace(/\\\\text\\{([^}]*)\\}/g, '$1');\n    result = result.replace(/\\\\frac\\{([^}]*)\\}\\{([^}]*)\\}/g, '($1)/($2)');\n    result = result.replace(/\\\\sqrt\\{([^}]*)\\}/g, '($1)');\n    \n    // \n    result = this.processSupSubScripts(result);\n    \n    // LaTeXUnicode\n    const sortedCommands = Object.keys(LATEX_UNICODE_MAP).sort((a, b) => b.length - a.length);\n    sortedCommands.forEach(command => {\n      const pattern = new RegExp(`\\\\\\\\${command}(?![a-zA-Z])`, 'g');\n      result = result.replace(pattern, LATEX_UNICODE_MAP[command]);\n    });\n    \n    // \n    result = result.replace(/\\\\([a-zA-Z]+)/g, '$1');\n    result = result.replace(/\\\\(.)/g, '$1');\n    result = result.replace(/[{}]/g, '');\n    \n    return result.trim();\n  }\n}\n\n// \nexport function createLaTeXRenderer(pdf, config) {\n  return new LaTeXRenderer(pdf, config);\n}\n","// PDF - \n\nimport { cleanText, cleanCodeText, parseInlineMarkdown, parseCodeLineBold, applyCJKPunctuationRules } from './pdfTextHelpers'\nimport { LaTeXRenderer } from './pdfLatexRenderer'\n\n// ============  ============\nconst RENDER_CONSTANTS = {\n  // \n  LINE_HEIGHT_TITLE: 1.5,\n  LINE_HEIGHT_SENDER: 1.2,\n  LINE_HEIGHT_HEADING: 1.2,\n  LINE_HEIGHT_TABLE_ROW: 1.8,\n  \n  // \n  BODY_END_SPACING: 0.3,\n  HEADING_AFTER_SPACING: 0.5,\n  HR_SPACING_ABOVE: 0.8,\n  HR_SPACING_BELOW: 4,\n  LATEX_DISPLAY_SPACING: 0.05,\n  TOC_ENTRY_SPACING: 1.5,\n  \n  // \n  LIST_INDENT_PER_LEVEL: 8,   // \n  LIST_BULLET_OFFSET: 2,      // \n  \n  // \n  CODE_LINE_NUMBER_WIDTH: 8,\n  CODE_PADDING: 3,\n  CODE_BORDER_RADIUS: 1.5,\n  \n  // \n  TABLE_CELL_PADDING: 3,\n  TABLE_HEADER_BG: [245, 245, 245],\n  \n  // \n  QUOTE_INDENT: 6,\n  QUOTE_LINE_WIDTH: 0.5,\n};\n\n//  (: mm)\nexport const PAGE_FORMATS = {\n  a3: { width: 297, height: 420, name: 'A3' },\n  a4: { width: 210, height: 297, name: 'A4' },\n  letter: { width: 215.9, height: 279.4, name: 'Letter' },\n  supernote: { width: 163, height: 217, name: 'Supernote (10.7\")' }\n};\n\nexport const PDF_STYLES = {\n  // \n  FONT_SIZE_TITLE: 20,\n  FONT_SIZE_H1: 16,\n  FONT_SIZE_H2: 14,\n  FONT_SIZE_SENDER: 12,\n  FONT_SIZE_BODY: 10,\n  FONT_SIZE_CODE: 9,\n  FONT_SIZE_TIMESTAMP: 8,\n  FONT_SIZE_HEADER: 8,\n  FONT_SIZE_FOOTER: 8,\n\n  //  (RGB)\n  COLOR_SENDER_HUMAN: [0, 102, 204],      // \n  COLOR_SENDER_ASSISTANT: [102, 102, 102], // \n  COLOR_TIMESTAMP: [150, 150, 150],        // \n  COLOR_CODE_BG: [245, 245, 245],          // \n  COLOR_SECTION_BG: [250, 250, 250],       // \n  COLOR_TEXT: [0, 0, 0],                   // \n  COLOR_HEADER: [100, 100, 100],           // \n  COLOR_FOOTER: [150, 150, 150],           // \n  COLOR_BORDER: [200, 200, 200],           // \n\n  // \n  MARGIN_LEFT: 15,\n  MARGIN_RIGHT: 15,\n  MARGIN_TOP: 15,    // \n  MARGIN_BOTTOM: 25, // \n  LINE_HEIGHT: 5,\n  SECTION_SPACING: 8,\n  MESSAGE_SPACING: 10,\n  FOOTER_HEIGHT: 15, // \n\n  //  ( A4)\n  PAGE_WIDTH: 210,\n  PAGE_HEIGHT: 297,\n};\n\n/**\n *  PDF_STYLES \n * @param {string} format -  ('a3', 'a4', 'letter', 'supernote')\n */\nexport function updatePageFormat(format = 'a4') {\n  const pageFormat = PAGE_FORMATS[format] || PAGE_FORMATS.a4;\n  PDF_STYLES.PAGE_WIDTH = pageFormat.width;\n  PDF_STYLES.PAGE_HEIGHT = pageFormat.height;\n  return pageFormat;\n}\n\n/**\n * \n */\nexport class ContentRenderer {\n  constructor(manager) {\n    this.manager = manager;\n    this.latexRenderer = null; // \n  }\n\n  /**\n   * PDF\n   */\n  get pdf() {\n    return this.manager.pdf;\n  }\n\n  /**\n   * Y\n   */\n  get currentY() {\n    return this.manager.currentY;\n  }\n\n  set currentY(value) {\n    this.manager.currentY = value;\n  }\n\n  /**\n   * \n   */\n  get config() {\n    return this.manager.config;\n  }\n\n  /**\n   * \n   */\n  get chineseFontName() {\n    return this.manager.chineseFontName;\n  }\n\n  get availableFontWeights() {\n    return this.manager.availableFontWeights;\n  }\n\n  /**\n   * manager\n   */\n  safeSetFont(fontName, fontStyle) {\n    return this.manager.safeSetFont(fontName, fontStyle);\n  }\n\n  safeGetTextWidth(text) {\n    return this.manager.safeGetTextWidth(text);\n  }\n\n  safeRenderText(text, x, y, maxWidth) {\n    return this.manager.safeRenderText(text, x, y, maxWidth);\n  }\n\n  checkPageBreak(requiredSpace) {\n    return this.manager.checkPageBreak(requiredSpace);\n  }\n\n\n  /**\n   * \n   */\n  renderTitle(meta) {\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_TITLE);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n\n    const rawTitle = meta.name || 'Conversation';\n    const title = cleanText(rawTitle); // \n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n\n    // ,\n    let titleLines;\n    try {\n      titleLines = this.pdf.splitTextToSize(title, maxWidth);\n    } catch (error) {\n      console.error('[PDF] ,:', error);\n      titleLines = [title];\n    }\n    \n    titleLines.forEach(line => {\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_TITLE);\n      const cleanLine = cleanText(line);\n      if (cleanLine && cleanLine.trim().length > 0) {\n        this.pdf.text(cleanLine, PDF_STYLES.MARGIN_LEFT, this.currentY);\n      }\n      this.currentY += PDF_STYLES.LINE_HEIGHT * 1.5;\n    });\n\n    this.currentY += PDF_STYLES.SECTION_SPACING;\n  }\n\n  /**\n   * \n   */\n  renderMetadata(meta) {\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TIMESTAMP);\n\n    const lines = [];\n\n    if (meta.platform) {\n      lines.push(`Platform: ${meta.platform}`);\n    }\n\n    if (meta.created_at) {\n      lines.push(`Created: ${meta.created_at}`);\n    }\n\n    if (meta.updated_at) {\n      lines.push(`Updated: ${meta.updated_at}`);\n    }\n\n    lines.push(`Exported: ${this.manager.exportDate}`);\n\n    lines.forEach(line => {\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n      this.pdf.text(line, PDF_STYLES.MARGIN_LEFT, this.currentY);\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    });\n  }\n\n  /**\n   * LaTeX\n   */\n  renderMessage(message, index) {\n    this.checkPageBreak(PDF_STYLES.FONT_SIZE_SENDER + PDF_STYLES.MESSAGE_SPACING);\n\n    // \n    const currentPage = this.pdf.internal.getCurrentPageInfo().pageNumber;\n    const currentY = this.currentY;\n    this.manager.messageAnchors.push({\n      index,\n      page: currentPage,\n      y: currentY,\n      sender: message.sender,\n      title: message.display_text ? message.display_text.substring(0, 50) : ''\n    });\n\n    // \n    this.renderSender(message, index);\n\n    // \n    if (this.config.includeTimestamps && message.timestamp) {\n      this.renderTimestamp(message.timestamp);\n    }\n\n    // thinking()\n    if (message.thinking && this.config.includeThinking && message.sender !== 'human') {\n      this.renderThinking(message.thinking);\n    }\n\n    // LaTeX\n    if (message.display_text) {\n      this.renderBody(message.display_text);\n    }\n\n    // \n    if (message.attachments?.length > 0 && message.sender === 'human') {\n      this.renderAttachments(message.attachments);\n    }\n\n    // Artifacts\n    if (message.artifacts?.length > 0 && this.config.includeArtifacts && message.sender !== 'human') {\n      message.artifacts.forEach(artifact => {\n        this.renderArtifact(artifact);\n      });\n    }\n\n    // \n    if (message.tools?.length > 0 && this.config.includeTools) {\n      message.tools.forEach(tool => {\n        this.renderTool(tool);\n      });\n    }\n\n    // \n    if (message.citations?.length > 0 && this.config.includeCitations) {\n      this.renderCitations(message.citations);\n    }\n\n    // \n    this.currentY += PDF_STYLES.MESSAGE_SPACING;\n  }\n\n  /**\n   * \n   */\n  renderSender(message, index) {\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_SENDER);\n\n    // \n    const color = message.sender === 'human'\n      ? PDF_STYLES.COLOR_SENDER_HUMAN\n      : PDF_STYLES.COLOR_SENDER_ASSISTANT;\n\n    this.pdf.setTextColor(...color);\n\n    // \n    const senderLabel = message.sender === 'human' ? 'Human' : 'Assistant';\n    const label = `${index}. ${senderLabel}`;\n\n    // \n    let finalLabel = label;\n    if (message.branchInfo?.isBranchPoint) {\n      const branchMarker = ` [Branch ${message.branchInfo.childCount}]`;\n      finalLabel = label + branchMarker;\n    }\n\n    // \n    const cleanLabel = cleanText(finalLabel);\n    if (cleanLabel && cleanLabel.trim().length > 0) {\n      this.pdf.text(cleanLabel, PDF_STYLES.MARGIN_LEFT, this.currentY);\n    }\n\n    this.currentY += PDF_STYLES.LINE_HEIGHT * 1.2;\n  }\n\n  /**\n   * \n   */\n  renderTimestamp(timestamp) {\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TIMESTAMP);\n    this.pdf.text(timestamp, PDF_STYLES.MARGIN_LEFT, this.currentY);\n    this.currentY += PDF_STYLES.LINE_HEIGHT;\n  }\n\n  /**\n   * LaTeX\n   */\n  renderBody(text) {\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n\n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n\n    // LaTeX\n    const parts = this.manager.parseTextWithCodeBlocksAndLatex(text);\n\n    // \n    for (const part of parts) {\n      if (part.type === 'code') {\n        this.renderCodeBlock(part.content, part.language);\n      } else if (part.type === 'latex-display') {\n        this.renderLatexDisplay(part);\n      } else {\n        // markdowninline LaTeX\n        this.renderMarkdownText(part.content, maxWidth);\n      }\n    }\n\n    // \n    this.currentY += PDF_STYLES.LINE_HEIGHT * 0.3;\n  }\n\n\n  /**\n   * LaTeX\n   */\n  getLatexRenderer() {\n    if (!this.latexRenderer) {\n      this.latexRenderer = new LaTeXRenderer(this.pdf, {\n        fontSize: PDF_STYLES.FONT_SIZE_BODY,\n        color: PDF_STYLES.COLOR_TEXT,\n        fontName: this.chineseFontName  // Unicode\n      });\n    }\n    return this.latexRenderer;\n  }\n\n  /**\n   * LaTeX\n   */\n  containsLatex(text) {\n    const latexPatterns = [\n      /\\$[^$]+\\$/,           //  $...$\n      /\\\\\\([^)]+\\\\\\)/,       //  \\(...\\)\n      /\\\\\\[[^\\]]+\\\\\\]/,      //  \\[...\\]\n      /\\\\(mathcal|mathbb|frac|sqrt|sum|int|lim|alpha|beta|gamma|delta|theta|lambda|mu|omega)/  // LaTeX\n    ];\n    return latexPatterns.some(pattern => pattern.test(text));\n  }\n\n  /**\n   * LaTeX display math- \n   */\n  renderLatexDisplay(part) {\n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n\n    this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY + 30);\n\n    try {\n      // LaTeX\n      const renderer = this.getLatexRenderer();\n      const result = renderer.renderDisplayLaTeX(\n        part.content,\n        PDF_STYLES.MARGIN_LEFT,\n        this.currentY + PDF_STYLES.FONT_SIZE_BODY,\n        maxWidth\n      );\n\n      // Y - \n      this.currentY += result.height + PDF_STYLES.LINE_HEIGHT * 0.05;  // \n    } catch (error) {\n      console.warn('[PDF] LaTeX:', error);\n\n      // LaTeX\n      this.renderLatexDisplayAsSource(part, maxWidth);\n    }\n  }\n\n  /**\n   * LaTeX display math\n   */\n  renderLatexDisplayAsSource(part, maxWidth) {\n    // LaTeX\n    this.pdf.setFillColor(240, 248, 255);\n    this.pdf.rect(\n      PDF_STYLES.MARGIN_LEFT,\n      this.currentY - 3,\n      maxWidth,\n      PDF_STYLES.LINE_HEIGHT * 3,\n      'F'\n    );\n\n    // \n    this.pdf.setDrawColor(100, 150, 200);\n    this.pdf.setLineWidth(0.5);\n    this.pdf.roundedRect(\n      PDF_STYLES.MARGIN_LEFT,\n      this.currentY - 3,\n      maxWidth,\n      PDF_STYLES.LINE_HEIGHT * 3,\n      1.5,\n      1.5,\n      'S'\n    );\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    this.pdf.setTextColor(70, 130, 180);\n    this.pdf.text('[LaTeX]', PDF_STYLES.MARGIN_LEFT + 2, this.currentY);\n    this.currentY += PDF_STYLES.LINE_HEIGHT;\n\n    // LaTeX\n    this.pdf.setFont('courier', 'normal');\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_CODE);\n    this.pdf.setTextColor(50, 50, 50);\n\n    const sourceLines = this.pdf.splitTextToSize(part.content, maxWidth - 4);\n    sourceLines.forEach(line => {\n      this.pdf.text(line, PDF_STYLES.MARGIN_LEFT + 2, this.currentY);\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    });\n\n    // \n    this.pdf.setFont(this.chineseFontName, 'normal');\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n    this.currentY += PDF_STYLES.SECTION_SPACING;\n  }\n\n  /**\n   * ()\n   */\n  renderPlainText(text, maxWidth) {\n    // \n    if (!text || text.trim().length === 0) {\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n      return;\n    }\n\n    // \n    const cleanedText = cleanText(text);\n    \n    if (!cleanedText || cleanedText.trim().length === 0) {\n      console.warn('[PDF] ');\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n      return;\n    }\n\n    //  splitTextToSize ,Unicode\n    let lines;\n    try {\n      lines = this.pdf.splitTextToSize(cleanedText, maxWidth);\n    } catch (error) {\n      console.error('[PDF] splitTextToSize:', error);\n      // splitTextToSize,\n      lines = cleanedText.split('\\n');\n    }\n\n    lines.forEach(line => {\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n      \n      // splitTextToSize\n      const cleanLine = cleanText(line);\n      if (cleanLine && cleanLine.trim().length > 0) {\n        this.pdf.text(cleanLine, PDF_STYLES.MARGIN_LEFT, this.currentY);\n      }\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    });\n  }\n\n  /**\n   * - \n   */\n  renderCodeBlock(code, language = '') {\n    this.checkPageBreak(PDF_STYLES.FONT_SIZE_CODE + PDF_STYLES.SECTION_SPACING * 2);\n\n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n    const lineNumberWidth = 8;\n    const codeWidth = maxWidth - lineNumberWidth - 8;\n    const padding = 3;\n\n    const cleanCode = cleanCodeText(code);  // \n    const cleanLanguage = cleanText(language);\n\n    // \n    if (cleanLanguage) {\n      this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n      this.pdf.setTextColor(100, 100, 100);\n      const labelText = cleanLanguage.toUpperCase();\n      const labelWidth = this.safeGetTextWidth(labelText) + 4;\n      this.pdf.setFillColor(220, 220, 220);\n      this.pdf.roundedRect(\n        PDF_STYLES.MARGIN_LEFT,\n        this.currentY - 3,\n        labelWidth,\n        5,\n        1,\n        1,\n        'F'\n      );\n      this.pdf.text(labelText, PDF_STYLES.MARGIN_LEFT + 2, this.currentY);\n      this.currentY += PDF_STYLES.LINE_HEIGHT * 1.2;\n    }\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_CODE);\n    this.pdf.setFont(this.chineseFontName);\n    const codeLines = cleanCode.split('\\n');\n    const wrappedLines = [];\n\n    codeLines.forEach(line => {\n      if (!line) {\n        wrappedLines.push({ text: '', lineNumber: wrappedLines.length + 1 });\n        return;\n      }\n      const cleanLine = cleanCodeText(line);  // \n      if (!cleanLine) {\n        wrappedLines.push({ text: '', lineNumber: wrappedLines.length + 1 });\n        return;\n      }\n\n      try {\n        const wrapped = this.pdf.splitTextToSize(cleanLine, codeWidth);\n        wrapped.forEach((wLine, idx) => {\n          wrappedLines.push({\n            text: wLine,\n            lineNumber: idx === 0 ? wrappedLines.length + 1 : null\n          });\n        });\n      } catch (error) {\n        wrappedLines.push({ text: cleanLine, lineNumber: wrappedLines.length + 1 });\n      }\n    });\n\n    // \n    const blockStartY = this.currentY;\n    const blockStartPage = this.pdf.internal.getCurrentPageInfo().pageNumber;\n\n    // \n    const firstPageHeight = Math.min(\n      wrappedLines.length * PDF_STYLES.LINE_HEIGHT + padding * 2,\n      PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM - this.currentY\n    );\n    this.pdf.setFillColor(248, 248, 248);\n    this.pdf.rect(\n      PDF_STYLES.MARGIN_LEFT,\n      blockStartY - padding,\n      maxWidth,\n      firstPageHeight,\n      'F'\n    );\n\n    this.currentY = blockStartY;\n\n    wrappedLines.forEach(({ text, lineNumber }, index) => {\n      // \n      if (this.currentY + PDF_STYLES.FONT_SIZE_CODE > PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM) {\n        // \n        this.pdf.setDrawColor(200, 200, 200);\n        this.pdf.setLineWidth(0.3);\n        const currentPageBottom = this.currentY;\n        this.pdf.line(\n          PDF_STYLES.MARGIN_LEFT,\n          blockStartY - padding,\n          PDF_STYLES.MARGIN_LEFT,\n          currentPageBottom\n        );\n        this.pdf.line(\n          PDF_STYLES.MARGIN_LEFT + maxWidth,\n          blockStartY - padding,\n          PDF_STYLES.MARGIN_LEFT + maxWidth,\n          currentPageBottom\n        );\n\n        // \n        this.pdf.addPage();\n        this.currentY = PDF_STYLES.MARGIN_TOP;\n        \n        // \n        const remainingLines = wrappedLines.length - index;\n        const newPageHeight = Math.min(\n          remainingLines * PDF_STYLES.LINE_HEIGHT + padding,\n          PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM - this.currentY\n        );\n        this.pdf.setFillColor(248, 248, 248);\n        this.pdf.rect(\n          PDF_STYLES.MARGIN_LEFT,\n          this.currentY - padding,\n          maxWidth,\n          newPageHeight,\n          'F'\n        );\n      }\n\n      // \n      if (lineNumber !== null) {\n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_CODE - 1);\n        this.pdf.setTextColor(150, 150, 150);\n        const lineNumStr = String(lineNumber).padStart(3, ' ');\n        this.pdf.text(lineNumStr, PDF_STYLES.MARGIN_LEFT + 1, this.currentY);\n      }\n\n      //  ****  ### \n      const safeLine = cleanCodeText(text);  // \n      if (safeLine !== null && safeLine !== undefined) {\n        // \n        const segments = parseCodeLineBold(safeLine);\n        const isHeading = segments.some(s => s.heading);\n\n        // \n        if (isHeading) {\n          const level = segments[0].heading;\n          const headingSizes = [14, 13, 12, 11, 10, 10]; // H1-H6 \n          this.pdf.setFontSize(headingSizes[level - 1] || PDF_STYLES.FONT_SIZE_CODE);\n          this.pdf.setTextColor(20, 20, 20); // \n        } else {\n          this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_CODE);\n          this.pdf.setTextColor(50, 50, 50);\n        }\n\n        let currentX = PDF_STYLES.MARGIN_LEFT + lineNumberWidth + 2;\n\n        segments.forEach(segment => {\n          // bold\n          if ((segment.heading || segment.bold) && this.availableFontWeights.includes('bold')) {\n            this.pdf.setFont(this.chineseFontName, 'bold');\n          } else {\n            // \n            this.pdf.setFont(this.chineseFontName, 'normal');\n          }\n\n          this.pdf.text(segment.text, currentX, this.currentY);\n          currentX += this.safeGetTextWidth(segment.text);\n        });\n\n        // \n        this.pdf.setFont(this.chineseFontName, 'normal');\n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_CODE);\n        this.pdf.setTextColor(50, 50, 50);\n      }\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    });\n\n    // \n    const endPage = this.pdf.internal.getCurrentPageInfo().pageNumber;\n    \n    // \n    for (let page = blockStartPage; page <= endPage; page++) {\n      this.pdf.setPage(page);\n      const isFirst = (page === blockStartPage);\n      const isLast = (page === endPage);\n      \n      let boxStartY, boxEndY;\n      if (isFirst && isLast) {\n        // \n        boxStartY = blockStartY - padding;\n        boxEndY = this.currentY + padding;\n      } else if (isFirst) {\n        // \n        boxStartY = blockStartY - padding;\n        boxEndY = PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM;\n      } else if (isLast) {\n        // \n        boxStartY = PDF_STYLES.MARGIN_TOP - padding;\n        boxEndY = this.currentY + padding;\n      } else {\n        // \n        boxStartY = PDF_STYLES.MARGIN_TOP - padding;\n        boxEndY = PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM;\n      }\n      \n      // \n      this.pdf.setDrawColor(200, 200, 200);\n      this.pdf.setLineWidth(0.3);\n      if (isFirst && isLast) {\n        this.pdf.roundedRect(PDF_STYLES.MARGIN_LEFT, boxStartY, maxWidth, boxEndY - boxStartY, 1.5, 1.5, 'S');\n      } else {\n        this.pdf.line(PDF_STYLES.MARGIN_LEFT, boxStartY, PDF_STYLES.MARGIN_LEFT, boxEndY);\n        this.pdf.line(PDF_STYLES.MARGIN_LEFT + maxWidth, boxStartY, PDF_STYLES.MARGIN_LEFT + maxWidth, boxEndY);\n        if (isFirst) {\n          this.pdf.line(PDF_STYLES.MARGIN_LEFT, boxStartY, PDF_STYLES.MARGIN_LEFT + maxWidth, boxStartY);\n        }\n        if (isLast) {\n          this.pdf.line(PDF_STYLES.MARGIN_LEFT, boxEndY, PDF_STYLES.MARGIN_LEFT + maxWidth, boxEndY);\n        }\n      }\n      \n      // \n      this.pdf.setDrawColor(220, 220, 220);\n      this.pdf.setLineWidth(0.2);\n      this.pdf.line(\n        PDF_STYLES.MARGIN_LEFT + lineNumberWidth,\n        boxStartY,\n        PDF_STYLES.MARGIN_LEFT + lineNumberWidth,\n        boxEndY\n      );\n    }\n\n    // \n    this.pdf.setPage(endPage);\n    \n    // \n    this.pdf.setFont(this.chineseFontName);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n    this.currentY += PDF_STYLES.SECTION_SPACING;\n  }\n\n  /**\n   * markdownLaTeX\n   */\n  renderMarkdownText(text, maxWidth) {\n    if (!text || text.trim().length === 0) {\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n      return;\n    }\n\n    const cleanedText = cleanText(text);\n    if (!cleanedText || cleanedText.trim().length === 0) {\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n      return;\n    }\n\n    // \n    const lines = cleanedText.split('\\n');\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i];\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n\n      // \n      if (line.trim() === '') {\n        // \n        this.currentY += PDF_STYLES.LINE_HEIGHT;\n      } else if (line.match(/^#{1,6}\\s/)) {\n        // \n        this.renderMarkdownHeading(line, maxWidth);\n      } else if (line.match(/^(---|___|\\*\\*\\*)$/)) {\n        // ---, ___,  ***\n        this.renderHorizontalRule(maxWidth);\n      } else if (line.match(/^>\\s/)) {\n        // \n        this.renderMarkdownQuote(line, maxWidth);\n      } else if (line.match(/^\\|.*\\|/)) {\n        //  - \n        const tableLines = [line];\n        while (i + 1 < lines.length && lines[i + 1].match(/^\\|.*\\|/)) {\n          i++;\n          tableLines.push(lines[i]);\n        }\n        this.renderTable(tableLines);\n      } else if ((line.match(/^[-*+]\\s/) || line.match(/^\\d+\\.\\s/)) && this.containsLatex(line)) {\n        // LaTeX\n        this.renderLatexListItem(line, maxWidth);\n      } else if (line.match(/^[-*+]\\s/) || line.match(/^\\d+\\.\\s/)) {\n        // \n        this.renderMarkdownList(line, maxWidth);\n      } else {\n        // LaTeX\n        this.renderMarkdownInlineFormats(line, maxWidth);\n      }\n    }\n  }\n\n  /**\n   * LaTeX\n   */\n  renderLatexListItem(line, maxWidth) {\n    const { LIST_INDENT_PER_LEVEL } = RENDER_CONSTANTS;\n    \n    // \n    const cleanedLine = line.replace(/^[-*+]\\s+/, '').replace(/^\\d+\\.\\s+/, '');\n    const indentX = PDF_STYLES.MARGIN_LEFT + LIST_INDENT_PER_LEVEL;\n    const adjustedWidth = maxWidth - LIST_INDENT_PER_LEVEL;\n\n    // \n    this.renderMarkdownInlineFormatsWithOffset(cleanedLine, adjustedWidth, indentX);\n  }\n\n  /**\n   * \n   */\n  renderHorizontalRule(maxWidth) {\n    // \n    this.currentY += PDF_STYLES.LINE_HEIGHT * 0.8;\n\n    const lineY = this.currentY;\n\n    //  - \n    this.pdf.setDrawColor(230, 230, 230);  // \n    this.pdf.setLineWidth(0.2);  // \n    this.pdf.line(\n      PDF_STYLES.MARGIN_LEFT,\n      lineY,\n      PDF_STYLES.MARGIN_LEFT + maxWidth,\n      lineY\n    );\n\n    // <hr/> \n    this.currentY += PDF_STYLES.LINE_HEIGHT * 4;\n  }\n\n  /**\n   * markdown\n   */\n  renderMarkdownHeading(line, maxWidth) {\n    const match = line.match(/^(#{1,6})\\s+(.+)$/);\n    if (!match) {\n      this.renderPlainText(line, maxWidth);\n      return;\n    }\n\n    const level = match[1].length;\n    const text = match[2];\n\n    // \n    const fontSize = PDF_STYLES.FONT_SIZE_BODY + (7 - level) * 2;\n    const oldFontSize = this.pdf.internal.getFontSize();\n\n    this.pdf.setFontSize(fontSize);\n    // \n    this.safeSetFont(this.chineseFontName, 'bold');\n\n    try {\n      const lines = this.pdf.splitTextToSize(text, maxWidth);\n      lines.forEach(l => {\n        this.checkPageBreak(fontSize);\n        const cleanLine = cleanText(l);\n        if (cleanLine && cleanLine.trim().length > 0) {\n          this.pdf.text(cleanLine, PDF_STYLES.MARGIN_LEFT, this.currentY);\n        }\n        this.currentY += PDF_STYLES.LINE_HEIGHT * 1.2;\n      });\n    } catch (error) {\n      console.error('[PDF] :', error);\n      this.pdf.text(text, PDF_STYLES.MARGIN_LEFT, this.currentY);\n      this.currentY += PDF_STYLES.LINE_HEIGHT * 1.2;\n    }\n\n    // \n    this.pdf.setFontSize(oldFontSize);\n    this.safeSetFont(this.chineseFontName, 'normal');\n\n    this.currentY += PDF_STYLES.LINE_HEIGHT * 0.5; // \n  }\n\n  /**\n   * markdown\n   */\n  renderMarkdownQuote(line, maxWidth) {\n    const { QUOTE_INDENT, QUOTE_LINE_WIDTH } = RENDER_CONSTANTS;\n    \n    const text = line.replace(/^>\\s*/, '');\n    const quoteWidth = maxWidth - QUOTE_INDENT - 2;\n    const quoteX = PDF_STYLES.MARGIN_LEFT + QUOTE_INDENT;\n\n    // \n    this.pdf.setDrawColor(150, 150, 150);\n    this.pdf.setLineWidth(QUOTE_LINE_WIDTH);\n\n    const startY = this.currentY - 2;\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    this.pdf.setTextColor(100, 100, 100);\n\n    this.renderMarkdownInlineFormatsWithOffset(text, quoteWidth, quoteX);\n\n    // \n    this.pdf.line(\n      PDF_STYLES.MARGIN_LEFT + 2,\n      startY,\n      PDF_STYLES.MARGIN_LEFT + 2,\n      this.currentY - 2\n    );\n\n    // \n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n  }\n\n  /**\n   * Markdown\n   */\n  renderTable(tableLines) {\n    if (!tableLines || tableLines.length < 2) return;\n\n    const { TABLE_CELL_PADDING, TABLE_HEADER_BG } = RENDER_CONSTANTS;\n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n\n    // \n    const rows = [];\n    let headerRow = null;\n\n    tableLines.forEach((line, idx) => {\n      //  - -:\n      const checkCells = line.split('|').filter((c, i, arr) => i > 0 && i < arr.length - 1);\n      const isSeparator = checkCells.length > 0 && checkCells.every(cell => /^[\\s\\-:]+$/.test(cell));\n      if (isSeparator) {\n        return;\n      }\n\n      const cells = line\n        .split('|')\n        .map(cell => cell.trim())\n        .filter((cell, i, arr) => i > 0 && i < arr.length - 1);\n\n      if (cells.length > 0) {\n        const isHeaderRow = (idx === 0);\n        const rowData = { cells, isHeader: isHeaderRow };\n        rows.push(rowData);\n\n        // \n        if (isHeaderRow) {\n          headerRow = rowData;\n        }\n      }\n    });\n\n    if (rows.length === 0) return;\n\n    const colCount = Math.max(...rows.map(r => r.cells.length));\n    const cellWidth = maxWidth / colCount;\n    const maxTextWidth = cellWidth - TABLE_CELL_PADDING * 2;\n    const baseRowHeight = PDF_STYLES.LINE_HEIGHT * 1.8;\n\n    this.pdf.setDrawColor(200, 200, 200);\n    this.pdf.setLineWidth(0.3);\n\n    /**\n     *  <br> \n     */\n    const calculateCellLines = (cellText) => {\n      const processedText = this.processCellContent(cellText);\n      if (!processedText) return [];\n\n      // \n      const manualLines = processedText.split('\\n');\n      const allWrappedLines = [];\n\n      // \n      this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n      manualLines.forEach(line => {\n        if (!line.trim()) {\n          allWrappedLines.push('');\n          return;\n        }\n        try {\n          const wrapped = this.pdf.splitTextToSize(line, maxTextWidth);\n          allWrappedLines.push(...wrapped);\n        } catch (e) {\n          allWrappedLines.push(line);\n        }\n      });\n\n      return allWrappedLines;\n    };\n\n    /**\n     * \n     */\n    const calculateRowHeight = (row) => {\n      let maxLines = 1;\n      row.processedCells = row.cells.map(cell => {\n        const lines = calculateCellLines(cell);\n        maxLines = Math.max(maxLines, lines.length);\n        return lines;\n      });\n      //  =  *  + \n      return Math.max(baseRowHeight, maxLines * PDF_STYLES.LINE_HEIGHT + TABLE_CELL_PADDING * 2);\n    };\n\n    /**\n     * \n     */\n    const renderTableRow = (row, rowStartY, rowHeight) => {\n      row.cells.forEach((cell, colIdx) => {\n        const cellX = PDF_STYLES.MARGIN_LEFT + colIdx * cellWidth;\n        const cellLines = row.processedCells ? row.processedCells[colIdx] : calculateCellLines(cell);\n\n        // \n        if (row.isHeader) {\n          this.pdf.setFillColor(...TABLE_HEADER_BG);\n          this.pdf.rect(cellX, rowStartY, cellWidth, rowHeight, 'F');\n        }\n\n        // \n        this.pdf.setDrawColor(200, 200, 200);\n        this.pdf.rect(cellX, rowStartY, cellWidth, rowHeight, 'S');\n\n        // \n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n        if (row.isHeader) {\n          this.safeSetFont(this.chineseFontName, 'bold');\n          this.pdf.setTextColor(0, 0, 0);\n        } else {\n          this.safeSetFont(this.chineseFontName, 'normal');\n          this.pdf.setTextColor(50, 50, 50);\n        }\n\n        // \n        if (cellLines.length > 0) {\n          // \n          const totalTextHeight = cellLines.length * PDF_STYLES.LINE_HEIGHT;\n          const startTextY = rowStartY + (rowHeight - totalTextHeight) / 2 + PDF_STYLES.FONT_SIZE_BODY * 0.35;\n\n          cellLines.forEach((line, lineIdx) => {\n            const textY = startTextY + lineIdx * PDF_STYLES.LINE_HEIGHT;\n            const cleanLine = cleanText(line);\n            if (cleanLine) {\n              this.pdf.text(cleanLine, cellX + TABLE_CELL_PADDING, textY);\n            }\n          });\n        }\n      });\n    };\n\n    // \n    rows.forEach(row => {\n      row.height = calculateRowHeight(row);\n    });\n\n    // \n    const headerRowHeight = headerRow ? headerRow.height : 0;\n\n    // \n    rows.forEach((row, rowIdx) => {\n      const rowHeight = row.height;\n\n      // \n      const needsPageBreak = this.currentY + rowHeight > PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM;\n\n      if (needsPageBreak && rowIdx > 0) {\n        // \n        this.pdf.addPage();\n        this.currentY = PDF_STYLES.MARGIN_TOP;\n\n        // \n        if (headerRow) {\n          // \"\"\n          this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n          this.pdf.setTextColor(150, 150, 150);\n          this.pdf.text('()', PDF_STYLES.MARGIN_LEFT, this.currentY);\n          this.currentY += PDF_STYLES.LINE_HEIGHT * 0.8;\n\n          // \n          renderTableRow(headerRow, this.currentY, headerRowHeight);\n          this.currentY += headerRowHeight;\n        }\n      }\n\n      const rowStartY = this.currentY;\n      renderTableRow(row, rowStartY, rowHeight);\n      this.currentY = rowStartY + rowHeight;\n    });\n\n    this.safeSetFont(this.chineseFontName, 'normal');\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n    this.currentY += PDF_STYLES.SECTION_SPACING;\n  }\n\n  /**\n   * \n   * @param {string} cellText - \n   * @param {boolean} keepLineBreaks - \n   */\n  processCellContent(cellText, keepLineBreaks = false) {\n    if (!cellText) return '';\n\n    let result = cellText;\n\n    //  <br> \n    result = result.replace(/<br\\s*\\/?>/gi, '\\n');  // <br>, <br/>, <br />\n    result = result.replace(/<\\/br>/gi, '\\n');      // </br>\n\n    // LaTeX\n    result = result.replace(/\\$([^$]+)\\$/g, (match, latex) => {\n      try {\n        const renderer = this.getLatexRenderer();\n        return renderer.simplifyLaTeX(latex);\n      } catch (e) {\n        return latex;\n      }\n    });\n\n    // \n    result = result.replace(/\\*\\*([^*]+)\\*\\*/g, '$1');\n    result = result.replace(/__([^_]+)__/g, '$1');\n\n    // \n    result = result.replace(/\\*([^*]+)\\*/g, '$1');\n    result = result.replace(/_([^_]+)_/g, '$1');\n\n    // \n    result = result.replace(/`([^`]+)`/g, '$1');\n\n    return cleanText(result);\n  }\n\n  /**\n   * \n   */\n  truncateText(text, maxWidth) {\n    if (!text) return '';\n    const textWidth = this.safeGetTextWidth(text);\n    if (textWidth <= maxWidth) return text;\n\n    let truncated = text;\n    while (truncated.length > 0 && this.safeGetTextWidth(truncated + '...') > maxWidth) {\n      truncated = truncated.slice(0, -1);\n    }\n    return truncated + '...';\n  }\n\n  /**\n   * markdownLaTeX\n   * @param {string} line - \n   * @param {number} maxWidth - \n   * @param {number} indentLevel - 0\n   */\n  renderMarkdownList(line, maxWidth, indentLevel = 0) {\n    const { LIST_INDENT_PER_LEVEL, LIST_BULLET_OFFSET } = RENDER_CONSTANTS;\n    \n    let bullet = '';\n    let text = '';\n\n    // \n    const unorderedMatch = line.match(/^(\\s*)([-*+])\\s+(.+)$/);\n    const orderedMatch = line.match(/^(\\s*)(\\d+)\\.\\s+(.+)$/);\n\n    if (unorderedMatch) {\n      // 2 = 1\n      const leadingSpaces = unorderedMatch[1].length;\n      indentLevel = Math.floor(leadingSpaces / 2);\n      \n      // \n      const bullets = ['', '', '', ''];  // \n      bullet = bullets[indentLevel % bullets.length];\n      text = unorderedMatch[3];\n    } else if (orderedMatch) {\n      const leadingSpaces = orderedMatch[1].length;\n      indentLevel = Math.floor(leadingSpaces / 2);\n      \n      bullet = orderedMatch[2] + '.';\n      text = orderedMatch[3];\n    } else {\n      this.renderPlainText(line, maxWidth);\n      return;\n    }\n\n    // \n    const indentX = PDF_STYLES.MARGIN_LEFT + (indentLevel * LIST_INDENT_PER_LEVEL);\n    const bulletWidth = this.safeGetTextWidth(bullet + '  ');\n    const textX = indentX + bulletWidth;\n    const textWidth = maxWidth - (indentLevel * LIST_INDENT_PER_LEVEL) - bulletWidth;\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    this.pdf.text(bullet, indentX + LIST_BULLET_OFFSET, this.currentY);\n\n    // \n    try {\n      const segments = parseInlineMarkdown(text);\n      // MARGIN_LEFT\n      this.renderInlineSegmentsWithOffset(segments, textWidth, textX);\n    } catch (error) {\n      console.error('[PDF] :', error);\n      this.pdf.text(text, textX, this.currentY);\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    }\n  }\n\n  /**\n   * markdownLaTeX\n   */\n  renderMarkdownInlineFormats(line, maxWidth) {\n    this.renderMarkdownInlineFormatsWithOffset(line, maxWidth, PDF_STYLES.MARGIN_LEFT);\n  }\n  \n  /**\n   * markdown\n   * @param {string} line - \n   * @param {number} maxWidth - \n   * @param {number} startX - X\n   */\n  renderMarkdownInlineFormatsWithOffset(line, maxWidth, startX) {\n    if (!line || line.trim().length === 0) {\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n      return;\n    }\n\n    // LaTeX\n    const segments = parseInlineMarkdown(line);\n\n    // segmentsLaTeX\n    this.renderInlineSegmentsWithOffset(segments, maxWidth, startX);\n  }\n\n  /**\n   * segments\n   */\n  flattenSegments(segments, parentType = null) {\n    const result = [];\n\n    segments.forEach(segment => {\n      if (segment.children) {\n        // \n        const childSegments = this.flattenSegments(segment.children, segment.type);\n        result.push(...childSegments);\n      } else {\n        // \n        if (parentType) {\n          result.push({\n            ...segment,\n            type: this.mergeSegmentTypes(parentType, segment.type)\n          });\n        } else {\n          result.push(segment);\n        }\n      }\n    });\n\n    return result;\n  }\n\n  /**\n   * \n   */\n  mergeSegmentTypes(parentType, childType) {\n    if (childType === 'normal') {\n      return parentType;\n    }\n\n    if ((parentType === 'bold' && childType === 'italic') ||\n        (parentType === 'italic' && childType === 'bold')) {\n      return 'bold-italic';\n    }\n\n    return childType;\n  }\n\n  /**\n   * LaTeX\n   */\n  renderInlineSegments(segments, maxWidth) {\n    this.renderInlineSegmentsWithOffset(segments, maxWidth, PDF_STYLES.MARGIN_LEFT);\n  }\n  \n  /**\n   * \n   * @param {Array} segments - \n   * @param {number} maxWidth - \n   * @param {number} startX - X\n   */\n  renderInlineSegmentsWithOffset(segments, maxWidth, startX) {\n    // \n    const flatSegments = this.flattenSegments(segments);\n    \n    let currentX = startX;\n    let currentLineSegments = [];\n\n    flatSegments.forEach((segment, idx) => {\n      // LaTeXUnicode\n      let text;\n      let textWidth;\n\n      if (segment.type === 'latex-inline') {\n        // LaTeXsimplifyLaTeXUnicode\n        const renderer = this.getLatexRenderer();\n        text = renderer.simplifyLaTeX(segment.text);\n        // Unicode\n        this.applySegmentStyle(segment.type);\n        textWidth = this.safeGetTextWidth(text);\n      } else {\n        text = cleanText(segment.text || '');\n        if (!text) return;\n        // \n        this.applySegmentStyle(segment.type);\n        textWidth = this.safeGetTextWidth(text);\n      }\n\n      const availableWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT - currentX;\n\n      //  segment \n      if (textWidth > availableWidth && currentLineSegments.length === 0) {\n        // LaTeX\n        if (segment.type === 'latex-inline') {\n          console.warn('[PDF] LaTeX:', segment.text);\n          const segmentData = {\n            ...segment,\n            x: currentX\n          };\n          currentLineSegments.push(segmentData);\n          currentX += textWidth;\n          return;\n        }\n\n        //  segment\n        //  splitTextToSize \n        try {\n          const maxSegmentWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n          let splitLines = this.pdf.splitTextToSize(text, maxSegmentWidth);\n          // \n          splitLines = applyCJKPunctuationRules(splitLines);\n\n          // \n          for (let i = 0; i < splitLines.length - 1; i++) {\n            this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n            currentLineSegments = [{\n              ...segment,\n              x: PDF_STYLES.MARGIN_LEFT,\n              text: splitLines[i]\n            }];\n            this.renderSegmentLine(currentLineSegments);\n            this.currentY += PDF_STYLES.LINE_HEIGHT;\n          }\n\n          //  segment \n          const lastLine = splitLines[splitLines.length - 1];\n          const lastLineWidth = this.safeGetTextWidth(lastLine);\n          currentLineSegments = [{\n            ...segment,\n            x: PDF_STYLES.MARGIN_LEFT,\n            text: lastLine\n          }];\n          currentX = PDF_STYLES.MARGIN_LEFT + lastLineWidth;\n        } catch (error) {\n          console.warn('[PDF] :', error);\n          // \n          const segmentData = {\n            ...segment,\n            x: currentX\n          };\n          if (segment.type !== 'latex-inline') {\n            segmentData.text = text;\n          }\n          currentLineSegments.push(segmentData);\n          currentX += textWidth;\n        }\n        return;\n      }\n\n      // \n      if (currentX + textWidth > PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT && currentLineSegments.length > 0) {\n        // \n        this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n\n        // \n        this.renderSegmentLine(currentLineSegments);\n        this.currentY += PDF_STYLES.LINE_HEIGHT;\n\n        // \n        currentX = PDF_STYLES.MARGIN_LEFT;\n        currentLineSegments = [];\n\n        //  segment \n        if (textWidth > maxWidth) {\n          // LaTeX\n          if (segment.type === 'latex-inline') {\n            console.warn('[PDF] LaTeX:', segment.text);\n            currentLineSegments = [{\n              ...segment,\n              x: PDF_STYLES.MARGIN_LEFT\n            }];\n            currentX = PDF_STYLES.MARGIN_LEFT + textWidth;\n            return;\n          }\n\n          // segment \n          try {\n            let splitLines = this.pdf.splitTextToSize(text, maxWidth);\n            // \n            splitLines = applyCJKPunctuationRules(splitLines);\n            for (let i = 0; i < splitLines.length - 1; i++) {\n              this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n              const tempSegments = [{\n                ...segment,\n                x: PDF_STYLES.MARGIN_LEFT,\n                text: splitLines[i]\n              }];\n              this.renderSegmentLine(tempSegments);\n              this.currentY += PDF_STYLES.LINE_HEIGHT;\n            }\n            // \n            const lastLine = splitLines[splitLines.length - 1];\n            const lastLineWidth = this.safeGetTextWidth(lastLine);\n            currentLineSegments = [{\n              ...segment,\n              x: PDF_STYLES.MARGIN_LEFT,\n              text: lastLine\n            }];\n            currentX = PDF_STYLES.MARGIN_LEFT + lastLineWidth;\n          } catch (error) {\n            console.warn('[PDF] :', error);\n            const segmentData = {\n              ...segment,\n              x: currentX\n            };\n            if (segment.type !== 'latex-inline') {\n              segmentData.text = text;\n            }\n            currentLineSegments.push(segmentData);\n            currentX += textWidth;\n          }\n          return;\n        }\n      }\n\n      // \n      // latex-inlinesegment.text$\n      // text\n      const segmentData = {\n        ...segment,\n        x: currentX\n      };\n      // LaTeXtext\n      if (segment.type !== 'latex-inline') {\n        segmentData.text = text;\n      }\n      currentLineSegments.push(segmentData);\n      currentX += textWidth;\n    });\n\n    // \n    if (currentLineSegments.length > 0) {\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n      this.renderSegmentLine(currentLineSegments);\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    }\n\n    // \n    this.pdf.setFont(this.chineseFontName, 'normal');\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n  }\n\n  /**\n   *  segment LaTeX\n   */\n  renderSegmentLine(segments) {\n    segments.forEach(segment => {\n      this.applySegmentStyle(segment.type);\n\n      if (segment.type === 'latex-inline') {\n        try {\n          const renderer = this.getLatexRenderer();\n          renderer.renderInlineLaTeX(\n            segment.text,\n            segment.x,\n            this.currentY,\n            PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT - segment.x\n          );\n        } catch (error) {\n          console.warn('[PDF] LaTeX:', error);\n          this.pdf.text(segment.text, segment.x, this.currentY);\n        }\n      } else if (segment.type === 'link') {\n        this.pdf.textWithLink(segment.text, segment.x, this.currentY, {\n          url: segment.url || '#'\n        });\n        const textWidth = this.safeGetTextWidth(segment.text);\n        this.pdf.line(segment.x, this.currentY + 0.5, segment.x + textWidth, this.currentY + 0.5);\n      } else if (segment.type === 'code') {\n        const textWidth = this.safeGetTextWidth(segment.text);\n        const padding = 1;\n        this.pdf.setFillColor(245, 245, 245);\n        this.pdf.rect(segment.x - padding, this.currentY - 3, textWidth + padding * 2, 4, 'F');\n        this.pdf.text(segment.text, segment.x, this.currentY);\n      } else {\n        this.pdf.text(segment.text, segment.x, this.currentY);\n      }\n    });\n  }\n\n  /**\n   * segmentLaTeX\n   */\n  applySegmentStyle(type) {\n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n\n    switch (type) {\n      case 'latex-inline':\n        // LaTeX\n        try {\n          this.pdf.setFont(this.chineseFontName, 'italic');\n        } catch (e) {\n          this.pdf.setFont(this.chineseFontName, 'normal');\n        }\n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n        this.pdf.setTextColor(50, 50, 50); // \n        break;\n      case 'latex-display':\n        // Display LaTeX (handled separately in renderLatexDisplay)\n        break;\n      case 'bold':\n        console.log('[PDF] , :', this.chineseFontName, ':', this.availableFontWeights);\n        // \n        const boldSuccess = this.safeSetFont(this.chineseFontName, 'bold');\n        console.log('[PDF] safeSetFont :', boldSuccess);\n        if (!boldSuccess) {\n          // \n          console.warn('[PDF] :  RGB(20,20,150) + ', PDF_STYLES.FONT_SIZE_BODY + 1);\n          //  + \n          this.pdf.setTextColor(20, 20, 150); // \n          this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY + 1); // 1pt\n        } else {\n          console.log('[PDF] ');\n        }\n        break;\n      case 'italic':\n        //  light \n        const lightSuccess = this.safeSetFont(this.chineseFontName, 'light');\n        if (!lightSuccess) {\n          //  light\n          this.pdf.setTextColor(70, 130, 180); // \n        }\n        break;\n      case 'bold-italic':\n        //  bold normal + \n        const boldItalicSuccess = this.safeSetFont(this.chineseFontName, 'bolditalic');\n        if (!boldItalicSuccess) {\n          //  bold\n          const boldOnlySuccess = this.safeSetFont(this.chineseFontName, 'bold');\n          if (!boldOnlySuccess) {\n            // bold \n            this.pdf.setTextColor(30, 60, 120); // +\n            this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY + 0.5);\n          } else {\n            // bold \n            this.pdf.setTextColor(70, 130, 180); // \n          }\n        }\n        break;\n      case 'code':\n        this.pdf.setFont('courier', 'normal');\n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_CODE);\n        this.pdf.setTextColor(220, 50, 50);\n        break;\n      case 'link':\n        //  light \n        const linkLightSuccess = this.safeSetFont(this.chineseFontName, 'light');\n        if (!linkLightSuccess) {\n          this.safeSetFont(this.chineseFontName, 'normal');\n        }\n        this.pdf.setTextColor(0, 102, 204); // \n        break;\n      default:\n        this.safeSetFont(this.chineseFontName, 'normal');\n    }\n  }\n\n  /**\n   * thinking\n   */\n  renderThinking(thinking) {\n    this.renderSection(' Thinking', thinking, PDF_STYLES.COLOR_SECTION_BG);\n  }\n\n  /**\n   * Artifact\n   */\n  renderArtifact(artifact) {\n    const title = ` Artifact: ${artifact.title || 'Untitled'}`;\n    const content = artifact.content || '';\n    this.renderSection(title, content, PDF_STYLES.COLOR_SECTION_BG);\n  }\n\n  /**\n   * \n   */\n  renderTool(tool) {\n    const title = ` Tool: ${tool.name || 'Unknown'}`;\n    const content = `Input: ${JSON.stringify(tool.input, null, 2)}\\n\\nOutput: ${tool.output || 'N/A'}`;\n    this.renderSection(title, content, PDF_STYLES.COLOR_SECTION_BG);\n  }\n\n  /**\n   * \n   */\n  renderCitations(citations) {\n    const title = ' Citations';\n    const content = citations.map((cit, i) =>\n      `[${i + 1}] ${cit.title || cit.url || 'Unknown'}`\n    ).join('\\n');\n    this.renderSection(title, content, PDF_STYLES.COLOR_SECTION_BG);\n  }\n\n  /**\n   * \n   */\n  renderAttachments(attachments) {\n    const title = ' Attachments';\n    const content = attachments.map((att, i) =>\n      `[${i + 1}] ${att.file_name || att.name || 'file'} (${att.file_type || att.type || 'unknown'})`\n    ).join('\\n');\n    this.renderSection(title, content, PDF_STYLES.COLOR_SECTION_BG);\n  }\n\n  /**\n   * ()\n   */\n  renderSection(title, content, bgColor) {\n    this.checkPageBreak(PDF_STYLES.FONT_SIZE_H2 + PDF_STYLES.SECTION_SPACING * 2);\n\n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n    \n    // \n    const cleanTitle = cleanText(title);\n    const cleanContent = cleanText(content);\n    \n    // ,\n    let contentLines;\n    try {\n      contentLines = this.pdf.splitTextToSize(cleanContent, maxWidth - 4);\n    } catch (error) {\n      console.error('[PDF] :', error);\n      contentLines = cleanContent.split('\\n');\n    }\n    \n    const bgHeight = PDF_STYLES.LINE_HEIGHT * (contentLines.length + 2);\n\n    // \n    this.pdf.setFillColor(...bgColor);\n    this.pdf.rect(\n      PDF_STYLES.MARGIN_LEFT,\n      this.currentY - 3,\n      maxWidth,\n      bgHeight,\n      'F'\n    );\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_H2);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n    if (cleanTitle && cleanTitle.trim().length > 0) {\n      this.pdf.text(cleanTitle, PDF_STYLES.MARGIN_LEFT + 2, this.currentY);\n    }\n    this.currentY += PDF_STYLES.LINE_HEIGHT * 1.2;\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    contentLines.forEach(line => {\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY);\n      const cleanLine = cleanText(line);\n      if (cleanLine && cleanLine.trim().length > 0) {\n        this.pdf.text(cleanLine, PDF_STYLES.MARGIN_LEFT + 2, this.currentY);\n      }\n      this.currentY += PDF_STYLES.LINE_HEIGHT;\n    });\n\n    this.currentY += PDF_STYLES.SECTION_SPACING;\n  }\n\n  /**\n   * Table of Contents\n   */\n  renderTOCWithLinks(tocPage, messages) {\n    // \n    this.pdf.setPage(tocPage);\n    this.currentY = PDF_STYLES.MARGIN_TOP;\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_H1);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n    this.pdf.text('Table of Contents', PDF_STYLES.MARGIN_LEFT, this.currentY);\n    this.currentY += PDF_STYLES.LINE_HEIGHT * 2;\n\n    // \n    this.pdf.setDrawColor(...PDF_STYLES.COLOR_BORDER);\n    this.pdf.setLineWidth(0.3);\n    this.pdf.line(\n      PDF_STYLES.MARGIN_LEFT,\n      this.currentY,\n      PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT,\n      this.currentY\n    );\n    this.currentY += PDF_STYLES.LINE_HEIGHT;\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n    const maxWidth = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_LEFT - PDF_STYLES.MARGIN_RIGHT;\n\n    this.manager.messageAnchors.forEach((anchor, idx) => {\n      const message = messages[idx];\n      if (!message) return;\n\n      this.checkPageBreak(PDF_STYLES.FONT_SIZE_BODY * 2);\n\n      const messageNumber = `${anchor.index}.`;\n      const sender = anchor.sender === 'human' ? 'Human' : 'Assistant';\n\n      // 50\n      let preview = anchor.title || '';\n      preview = cleanText(preview);\n      preview = preview.replace(/\\n/g, ' ').substring(0, 50);\n      if (preview.length >= 50) {\n        preview += '...';\n      }\n\n      // \n      let branchMarker = '';\n      if (message.branchInfo?.isBranchPoint) {\n        branchMarker = ` [Branch ${message.branchInfo.childCount}]`;\n      }\n\n      // \n      const entry = `${messageNumber} ${sender}${branchMarker}`;\n      const pageNum = `p.${anchor.page}`;\n\n      // \n      const color = anchor.sender === 'human'\n        ? PDF_STYLES.COLOR_SENDER_HUMAN\n        : PDF_STYLES.COLOR_SENDER_ASSISTANT;\n      this.pdf.setTextColor(...color);\n\n      // \n      const pageNumWidth = this.safeGetTextWidth(pageNum);\n      const pageNumX = PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT - pageNumWidth;\n\n      // \n      const entryY = this.currentY;\n      this.pdf.textWithLink(entry, PDF_STYLES.MARGIN_LEFT + 5, entryY, {\n        pageNumber: anchor.page\n      });\n\n      // \n      this.pdf.setTextColor(...PDF_STYLES.COLOR_TIMESTAMP);\n      this.pdf.textWithLink(pageNum, pageNumX, entryY, {\n        pageNumber: anchor.page\n      });\n\n      // \n      if (preview) {\n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n        this.pdf.setTextColor(...PDF_STYLES.COLOR_TIMESTAMP);\n        this.currentY += PDF_STYLES.LINE_HEIGHT;\n        this.checkPageBreak(PDF_STYLES.FONT_SIZE_TIMESTAMP);\n        this.pdf.text(preview, PDF_STYLES.MARGIN_LEFT + 10, this.currentY);\n        this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_BODY);\n      }\n\n      this.currentY += PDF_STYLES.LINE_HEIGHT * 1.5;\n    });\n  }\n\n  /**\n   * \n   */\n  renderFooter(pageNumber, totalPages) {\n    const originalY = this.currentY;\n    const originalFontSize = this.pdf.internal.getFontSize();\n\n    // \n    this.pdf.setFontSize(PDF_STYLES.FONT_SIZE_FOOTER);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_FOOTER);\n\n    const footerY = PDF_STYLES.PAGE_HEIGHT - 10;\n\n    // \n    this.pdf.setDrawColor(...PDF_STYLES.COLOR_BORDER);\n    this.pdf.setLineWidth(0.1);\n    this.pdf.line(\n      PDF_STYLES.MARGIN_LEFT,\n      PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.FOOTER_HEIGHT,\n      PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT,\n      PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.FOOTER_HEIGHT\n    );\n\n    // \n    const exportText = `Exported: ${this.manager.exportDate}`;\n    this.pdf.text(exportText, PDF_STYLES.MARGIN_LEFT, footerY);\n\n    // \n    const pageText = `${pageNumber} / ${totalPages}`;\n    const pageTextWidth = this.safeGetTextWidth(pageText);\n    this.pdf.text(pageText, PDF_STYLES.PAGE_WIDTH - PDF_STYLES.MARGIN_RIGHT - pageTextWidth, footerY);\n\n    // \n    this.pdf.setFontSize(originalFontSize);\n    this.pdf.setTextColor(...PDF_STYLES.COLOR_TEXT);\n    this.currentY = originalY;\n  }\n}\n","// utils/export/pdfExportManager_new.js\n// PDF - jsPDFPDF\n//\n//  ARUDJingxihei RegularBoldLight \n//  Markdown \n//  LaTeX \nimport { jsPDF } from 'jspdf';\nimport { DateTimeUtils } from '../fileParser';\nimport { addChineseFontSupport } from './pdfFontHelper';\nimport { ContentRenderer, PDF_STYLES } from './pdfContentRenderers';\nimport * as textHelpers from './pdfTextHelpers';\n\n/**\n * PDF\n */\nexport class PDFExportManager {\n  constructor() {\n    this.pdf = null;\n    this.currentY = PDF_STYLES.MARGIN_TOP;\n    this.config = {};\n    this.useChineseFont = false; // \n    this.chineseFontName = 'helvetica'; // \n    this.availableFontWeights = []; //  (normal, bold, light )\n    this.isSystemFont = false; // \n    this.meta = null; // \n    this.exportDate = null; // \n    this.messageAnchors = []; // \n    this.contentRenderer = null; // \n    \n    // \n    this.cleanText = textHelpers.cleanText;\n    this.parseTextWithCodeBlocksAndLatex = textHelpers.parseTextWithCodeBlocksAndLatex;\n    this.parseInlineMarkdown = textHelpers.parseInlineMarkdown;\n    this.applyCJKPunctuationRules = textHelpers.applyCJKPunctuationRules;\n    this.parseCodeLineBold = textHelpers.parseCodeLineBold;\n  }\n\n  /**\n   * \n   * @param {string} fontName - \n   * @param {string} fontStyle -  (normal, bold, light, italic, bolditalic)\n   * @returns {boolean} - \n   */\n  safeSetFont(fontName, fontStyle = 'normal') {\n    return textHelpers.safeSetFont(this.pdf, fontName, fontStyle, this.availableFontWeights);\n  }\n\n  /**\n   * \n   * @param {string} text - \n   * @returns {number} - \n   */\n  safeGetTextWidth(text) {\n    return textHelpers.safeGetTextWidth(this.pdf, text, this.chineseFontName);\n  }\n\n  /**\n   * \n   * @param {string} text - \n   * @param {number} x - X \n   * @param {number} y - Y \n   * @param {number} maxWidth - \n   */\n  safeRenderText(text, x, y, maxWidth = null) {\n    return textHelpers.safeRenderText(this.pdf, text, x, y, maxWidth);\n  }\n\n  /**\n   * \n   * @param {Array} messages - \n   * @param {Object} meta - (title, platform, created_at, updated_at)\n   * @param {Object} config - \n   */\n  async exportToPDF(messages, meta, config = {}) {\n    console.log('[PDF] ', {\n      messageCount: messages.length,\n      config\n    });\n\n    // \n    this.meta = meta;\n    this.exportDate = DateTimeUtils.formatDateTime(new Date());\n    this.messageAnchors = []; // \n\n    this.config = {\n      includeThinking: config.includeThinking ?? false,\n      includeArtifacts: config.includeArtifacts ?? true,\n      includeTimestamps: config.includeTimestamps ?? false,\n      includeTools: config.includeTools ?? true,\n      includeCitations: config.includeCitations ?? true,\n      highQuality: config.highQuality ?? false,\n      ...config\n    };\n\n    // PDF\n    this.pdf = new jsPDF({\n      orientation: 'portrait',\n      unit: 'mm',\n      format: 'a4',\n      compress: true\n    });\n\n    // \n    try {\n      console.log('[PDF] ...');\n      console.log('[PDF]  addChineseFontSupport(this.pdf)...');\n      const fontLoadResult = await addChineseFontSupport(this.pdf);\n      console.log('[PDF] addChineseFontSupport :', fontLoadResult);\n\n      this.useChineseFont = fontLoadResult.success;\n      this.chineseFontName = fontLoadResult.fontName;\n      this.availableFontWeights = fontLoadResult.availableWeights || [];\n      this.isSystemFont = fontLoadResult.isSystemFont || false;\n\n      if (!this.useChineseFont) {\n        console.warn('[PDF]  ');\n        console.warn('[PDF] fontLoadResult:', JSON.stringify(fontLoadResult, null, 2));\n        if (fontLoadResult.systemFontAvailable) {\n          console.warn('[PDF] ');\n          console.warn('[PDF]  public/fonts/ ');\n        }\n      } else {\n        const fontType = this.isSystemFont ? '' : '';\n        console.log(`[PDF]  : ${this.chineseFontName} (${fontType})`);\n        console.log(`[PDF] : ${this.availableFontWeights.join(', ')}`);\n        if (fontLoadResult.systemFontInfo) {\n          console.log(`[PDF] : ${fontLoadResult.systemFontInfo.fontName}`);\n        }\n      }\n    } catch (error) {\n      console.error('[PDF]  :', error);\n      console.error('[PDF] :', error.stack);\n      this.useChineseFont = false;\n      this.chineseFontName = 'helvetica';\n      this.availableFontWeights = [];\n      this.isSystemFont = false;\n    }\n\n    // \n    this.pdf.setFont(this.chineseFontName);\n\n    // \n    this.contentRenderer = new ContentRenderer(this);\n\n    // \n    this.contentRenderer.renderTitle(meta);\n    this.contentRenderer.renderMetadata(meta);\n    this.currentY += PDF_STYLES.SECTION_SPACING;\n\n    // LaTeX\n    for (let i = 0; i < messages.length; i++) {\n      const message = messages[i];\n\n      // +AI\n      // \n      if (i > 0 && message.sender === 'human') {\n        this.pdf.addPage();\n        this.currentY = PDF_STYLES.MARGIN_TOP;\n      }\n\n      this.contentRenderer.renderMessage(message, i + 1);\n    }\n\n    // \n    const hasTOC = messages.length > 1;\n    if (hasTOC) {\n      console.log('[PDF] ...');\n      this.pdf.addPage();\n      const tocPageNumber = this.pdf.internal.getCurrentPageInfo().pageNumber;\n      this.currentY = PDF_STYLES.MARGIN_TOP;\n      this.contentRenderer.renderTOCWithLinks(tocPageNumber, messages);\n    }\n\n    // PDF\n    console.log('[PDF] PDF...');\n    this.addBookmarks();\n\n    // \n    console.log('[PDF] ...');\n    this.addFooters();\n\n    // \n    const fileName = this.generateFileName(meta);\n    this.pdf.save(fileName);\n\n    console.log('[PDF] :', fileName);\n    return true;\n  }\n\n  /**\n   * PDFoutline\n   */\n  addBookmarks() {\n    if (this.messageAnchors.length === 0) return;\n\n    // jsPDFoutline\n    // \n    try {\n      this.messageAnchors.forEach((anchor) => {\n        const sender = anchor.sender === 'human' ? 'Human' : 'Assistant';\n        const title = `${anchor.index}. ${sender}`;\n\n        // jsPDFoutline API\n        // jsPDFoutline\n        if (this.pdf.outline) {\n          this.pdf.outline.add(null, title, { pageNumber: anchor.page });\n        }\n      });\n    } catch (error) {\n      console.warn('[PDF] :', error);\n    }\n  }\n\n  /**\n   * \n   */\n  addFooters() {\n    const totalPages = this.pdf.internal.getNumberOfPages();\n\n    for (let i = 1; i <= totalPages; i++) {\n      this.pdf.setPage(i);\n      this.contentRenderer.renderFooter(i, totalPages);\n    }\n  }\n\n  /**\n   * \n   */\n  checkPageBreak(requiredSpace = 20) {\n    const bottomLimit = PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM;\n\n    if (this.currentY + requiredSpace > bottomLimit) {\n      this.pdf.addPage();\n      this.currentY = PDF_STYLES.MARGIN_TOP;\n    }\n  }\n\n  /**\n   * \n   * @param {Array} wrappedLines - \n   * @returns {Array} -  [{page, startY, lines: [...]}]\n   */\n  groupCodeLinesByPage(wrappedLines) {\n    const groups = [];\n    let currentGroup = null;\n    const bottomLimit = PDF_STYLES.PAGE_HEIGHT - PDF_STYLES.MARGIN_BOTTOM;\n\n    let simulatedY = this.currentY;\n    let simulatedPage = this.pdf.internal.getCurrentPageInfo().pageNumber;\n\n    wrappedLines.forEach((line) => {\n      // \n      if (simulatedY + PDF_STYLES.FONT_SIZE_CODE > bottomLimit) {\n        simulatedPage++;\n        simulatedY = PDF_STYLES.MARGIN_TOP;\n        currentGroup = null; // \n      }\n\n      // \n      if (!currentGroup || currentGroup.page !== simulatedPage) {\n        currentGroup = {\n          page: simulatedPage,\n          startY: simulatedY,\n          lines: []\n        };\n        groups.push(currentGroup);\n      }\n\n      // \n      currentGroup.lines.push(line);\n      simulatedY += PDF_STYLES.LINE_HEIGHT;\n    });\n\n    return groups;\n  }\n\n  /**\n   * \n   */\n  generateFileName(meta) {\n    const date = DateTimeUtils.getCurrentDate();\n    const cleanTitle = (meta.name || 'conversation').replace(/[^a-zA-Z0-9\\u4e00-\\u9fa5]/g, '_');\n    return `${cleanTitle}_${date}.pdf`;\n  }\n\n  /**\n   * \n   */\n  getPlatformPrefix(platform) {\n    const platformLower = (platform || '').toLowerCase();\n\n    if (platformLower.includes('chatgpt')) return 'chatgpt';\n    if (platformLower.includes('gemini')) return 'gemini';\n    if (platformLower.includes('notebooklm')) return 'notebooklm';\n    if (platformLower.includes('aistudio')) return 'aistudio';\n    if (platformLower.includes('sillytavern')) return 'sillytavern';\n\n    return 'claude';\n  }\n}\n\n// \nexport const pdfExportManager = new PDFExportManager();"],"names":["async","loadFontFromProject","pdf","fontPath","fontName","arguments","length","undefined","fontStyle","console","log","concat","arrayBuffer","base64","loadFontData","FontCache","has","hasCmap","version","DataView","getUint32","warn","buffer","Uint8Array","cmapSignature","i","Math","min","error","hasUnicodeCmap","fileName","split","pop","addFileToVFS","addFont","addFontError","message","Map","cached","get","dbCache","loadFromIndexedDB","set","timestamp","Date","now","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","signal","cache","clearTimeout","ok","Error","status","contentType","headers","includes","fileSizeMB","byteLength","toFixed","magic","toString","bytes","binary","chunkSize","chunk","subarray","String","fromCharCode","apply","btoa","fontData","Promise","resolve","reject","request","indexedDB","open","onerror","onupgradeneeded","event","db","target","result","objectStoreNames","contains","createObjectStore","keyPath","onsuccess","transaction","objectStore","put","path","oncomplete","close","saveToIndexedDB","catch","err","fetchError","name","getRequest","data","cleanCodeText","text","cleaned","normalize","replace","cleanText","ligatureMap","ligature","replacement","Object","entries","RegExp","quoteMap","from","to","ch","charCodeAt","parseTextWithCodeBlocksAndLatex","parts","elements","codeBlockRegex","match","lastIndex","exec","language","trim","toLowerCase","content","push","start","index","end","type","latexDisplayRegex","latexBracketRegex","sort","a","b","filteredElements","forEach","element","some","existing","plainText","substring","parseInlineMarkdown","segments","matches","regex","recursive","pattern","source","url","filteredMatches","lastEnd","innerSegments","children","applyCJKPunctuationRules","lines","noLineStart","noLineEnd","prevLine","currentLine","test","punct","parseCodeLineBold","line","headingMatch","level","headingText","boldRegex","bold","heading","safeSetFont","availableFontWeights","setFont","fallbackStyle","safeGetTextWidth","chineseFontName","font","getFont","metadata","Unicode","currentStyle","getTextWidth","fontSize","getFontSize","LATEX_RENDER_CONSTANTS","FRACTION_FONT_SCALE","SUPERSCRIPT_FONT_SCALE","SUBSCRIPT_FONT_SCALE","DISPLAY_FONT_SCALE","FRACTION_NUM_OFFSET","FRACTION_DEN_OFFSET","SUPERSCRIPT_OFFSET","SUBSCRIPT_OFFSET","FRACTION_PADDING","SQRT_PADDING","CACHE_MAX_SIZE","LATEX_UNICODE_MAP","MATHCAL_MAP","MATHBB_MAP","SUPERSCRIPT_MAP","SUPERSCRIPT_SAFE","SUBSCRIPT_MAP","extractBracedContent","str","startsWith","depth","LaTeXRenderer","constructor","config","this","_objectSpread","color","useUnicode","widthCache","cacheAccessOrder","setRenderFont","e","setFontSize","getCachedTextWidth","cacheKey","idx","indexOf","splice","width","size","oldestKey","shift","delete","clearWidthCache","clear","renderInlineLaTeX","latex","x","y","maxWidth","simplified","simplifyLaTeX","hasComplexStructure","renderComplexLaTeX","setTextColor","renderDisplayLaTeX","centerX","textWidth","startX","setFillColor","rect","padding","height","simplifyEnvironments","_","letter","inner","simplifiedInner","simplifyFractions","processSupSubScripts","keys","command","lastResult","fracMatch","startIdx","afterFrac","numerator","denominator","fullMatch","supMatch","endsWith","slice","converted","convertToSuperscript","subMatch","convertToSubscript","map","char","join","isInline","parseComplexLaTeX","totalWidth","fracFontSize","numWidth","denWidth","max","base","subSupFontSize","exponent","subscript","raw","currentX","maxHeight","hasFraction","fracWidth","renderFraction","sqrtWidth","renderSquareRoot","supWidth","renderSuperscript","subWidth","renderSubscript","fallbackText","fallbackWidth","remaining","fracRegex","beforeText","numOffset","denOffset","numX","setLineWidth","setDrawColor","denX","sqrtHeight","baseWidth","supFontSize","supText","subFontSize","subText","matrixTypes","matrixBrackets","mtype","leftBracket","rightBracket","simplifyMatrixContent","simplifyCasesContent","simplifyAlignContent","row","filter","cell","simplifyLaTeXBasic","part","RENDER_CONSTANTS","LINE_HEIGHT_TITLE","LINE_HEIGHT_SENDER","LINE_HEIGHT_HEADING","LINE_HEIGHT_TABLE_ROW","BODY_END_SPACING","HEADING_AFTER_SPACING","HR_SPACING_ABOVE","HR_SPACING_BELOW","LATEX_DISPLAY_SPACING","TOC_ENTRY_SPACING","LIST_INDENT_PER_LEVEL","LIST_BULLET_OFFSET","CODE_LINE_NUMBER_WIDTH","CODE_PADDING","CODE_BORDER_RADIUS","TABLE_CELL_PADDING","TABLE_HEADER_BG","QUOTE_INDENT","QUOTE_LINE_WIDTH","PDF_STYLES","FONT_SIZE_TITLE","FONT_SIZE_H1","FONT_SIZE_H2","FONT_SIZE_SENDER","FONT_SIZE_BODY","FONT_SIZE_CODE","FONT_SIZE_TIMESTAMP","FONT_SIZE_HEADER","FONT_SIZE_FOOTER","COLOR_SENDER_HUMAN","COLOR_SENDER_ASSISTANT","COLOR_TIMESTAMP","COLOR_CODE_BG","COLOR_SECTION_BG","COLOR_TEXT","COLOR_HEADER","COLOR_FOOTER","COLOR_BORDER","MARGIN_LEFT","MARGIN_RIGHT","MARGIN_TOP","MARGIN_BOTTOM","LINE_HEIGHT","SECTION_SPACING","MESSAGE_SPACING","FOOTER_HEIGHT","PAGE_WIDTH","PAGE_HEIGHT","ContentRenderer","manager","latexRenderer","currentY","value","safeRenderText","checkPageBreak","requiredSpace","renderTitle","meta","title","titleLines","splitTextToSize","cleanLine","renderMetadata","platform","created_at","updated_at","exportDate","renderMessage","_message$attachments","_message$artifacts","_message$tools","_message$citations","currentPage","internal","getCurrentPageInfo","pageNumber","messageAnchors","page","sender","display_text","renderSender","includeTimestamps","renderTimestamp","thinking","includeThinking","renderThinking","renderBody","attachments","renderAttachments","artifacts","includeArtifacts","artifact","renderArtifact","tools","includeTools","tool","renderTool","citations","includeCitations","renderCitations","_message$branchInfo","senderLabel","label","finalLabel","branchInfo","isBranchPoint","childCount","cleanLabel","renderCodeBlock","renderLatexDisplay","renderMarkdownText","getLatexRenderer","containsLatex","renderLatexDisplayAsSource","roundedRect","renderPlainText","cleanedText","code","codeWidth","cleanCode","cleanLanguage","labelText","toUpperCase","labelWidth","codeLines","wrappedLines","lineNumber","wLine","blockStartY","blockStartPage","firstPageHeight","_ref","currentPageBottom","addPage","remainingLines","newPageHeight","lineNumStr","padStart","safeLine","s","headingSizes","segment","endPage","setPage","isFirst","isLast","boxStartY","boxEndY","renderMarkdownHeading","renderHorizontalRule","renderMarkdownQuote","tableLines","renderTable","renderLatexListItem","renderMarkdownList","renderMarkdownInlineFormats","cleanedLine","indentX","adjustedWidth","renderMarkdownInlineFormatsWithOffset","lineY","oldFontSize","l","quoteWidth","quoteX","startY","rows","headerRow","checkCells","c","arr","every","cells","isHeaderRow","rowData","isHeader","cellWidth","r","maxTextWidth","baseRowHeight","calculateCellLines","cellText","processedText","processCellContent","manualLines","allWrappedLines","wrapped","renderTableRow","rowStartY","rowHeight","colIdx","cellX","cellLines","processedCells","totalTextHeight","startTextY","lineIdx","textY","maxLines","calculateRowHeight","headerRowHeight","rowIdx","truncateText","truncated","indentLevel","bullet","unorderedMatch","orderedMatch","leadingSpaces","floor","bullets","bulletWidth","textX","renderInlineSegmentsWithOffset","flattenSegments","parentType","childSegments","mergeSegmentTypes","childType","renderInlineSegments","flatSegments","currentLineSegments","applySegmentStyle","segmentData","maxSegmentWidth","splitLines","renderSegmentLine","lastLine","lastLineWidth","tempSegments","textWithLink","boldSuccess","renderSection","JSON","stringify","input","output","cit","att","file_name","file_type","bgColor","cleanTitle","cleanContent","contentLines","bgHeight","renderTOCWithLinks","tocPage","messages","anchor","_message$branchInfo2","messageNumber","preview","branchMarker","entry","pageNum","pageNumWidth","pageNumX","entryY","renderFooter","totalPages","originalY","originalFontSize","footerY","exportText","pageText","pageTextWidth","PDFExportManager","useChineseFont","isSystemFont","contentRenderer","textHelpers","exportToPDF","_config$includeThinki","_config$includeArtifa","_config$includeTimest","_config$includeTools","_config$includeCitati","_config$highQuality","messageCount","DateTimeUtils","formatDateTime","highQuality","jsPDF","orientation","unit","format","compress","fontLoadResult","fontConfigs","style","weight","description","loadedCount","availableWeights","success","addChineseFontSupport","fontType","systemFontInfo","systemFontAvailable","stack","tocPageNumber","addBookmarks","addFooters","generateFileName","save","outline","add","getNumberOfPages","bottomLimit","groupCodeLinesByPage","groups","currentGroup","simulatedY","simulatedPage","date","getCurrentDate","getPlatformPrefix","platformLower"],"sourceRoot":""}